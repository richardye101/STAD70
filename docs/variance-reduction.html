<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Variance Reduction | STAD70 Course Work</title>
  <meta name="description" content="A collection of homework and assignments from the STAD70 course at UTSC" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Variance Reduction | STAD70 Course Work" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A collection of homework and assignments from the STAD70 course at UTSC" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Variance Reduction | STAD70 Course Work" />
  
  <meta name="twitter:description" content="A collection of homework and assignments from the STAD70 course at UTSC" />
  

<meta name="author" content="Richard Ye" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pricing-derivatives.html"/>
<link rel="next" href="optimization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.0/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAD70 Work</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html"><i class="fa fa-check"></i><b>2</b> Financial Data and Returns</a>
<ul>
<li class="chapter" data-level="2.1" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#trading"><i class="fa fa-check"></i><b>2.1</b> Trading</a></li>
<li class="chapter" data-level="2.2" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#order-types"><i class="fa fa-check"></i><b>2.2</b> Order Types</a></li>
<li class="chapter" data-level="2.3" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#returns"><i class="fa fa-check"></i><b>2.3</b> Returns</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#net-returns"><i class="fa fa-check"></i><b>2.3.1</b> Net Returns</a></li>
<li class="chapter" data-level="2.3.2" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#log-returns"><i class="fa fa-check"></i><b>2.3.2</b> Log Returns</a></li>
<li class="chapter" data-level="2.3.3" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#returns-accounting-for-dividends"><i class="fa fa-check"></i><b>2.3.3</b> Returns accounting for dividends</a></li>
<li class="chapter" data-level="2.3.4" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#returns-accounting-for-splits"><i class="fa fa-check"></i><b>2.3.4</b> Returns accounting for splits</a></li>
<li class="chapter" data-level="2.3.5" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#adjusted-returns"><i class="fa fa-check"></i><b>2.3.5</b> Adjusted returns</a></li>
<li class="chapter" data-level="2.3.6" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#random-walk-model"><i class="fa fa-check"></i><b>2.3.6</b> Random Walk Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="return-distributions.html"><a href="return-distributions.html"><i class="fa fa-check"></i><b>3</b> Return Distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="return-distributions.html"><a href="return-distributions.html#skewness"><i class="fa fa-check"></i><b>3.1</b> Skewness</a></li>
<li class="chapter" data-level="3.2" data-path="return-distributions.html"><a href="return-distributions.html#kurtosis"><i class="fa fa-check"></i><b>3.2</b> Kurtosis</a></li>
<li class="chapter" data-level="3.3" data-path="return-distributions.html"><a href="return-distributions.html#qq-plot"><i class="fa fa-check"></i><b>3.3</b> QQ Plot</a></li>
<li class="chapter" data-level="3.4" data-path="return-distributions.html"><a href="return-distributions.html#heavy-tail-distributions"><i class="fa fa-check"></i><b>3.4</b> Heavy Tail Distributions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="return-distributions.html"><a href="return-distributions.html#common-heavy-tail-distributions"><i class="fa fa-check"></i><b>3.4.1</b> Common Heavy Tail Distributions</a>
<ul>
<li class="chapter" data-level="3.4.1.1" data-path="return-distributions.html"><a href="return-distributions.html#pareto"><i class="fa fa-check"></i><b>3.4.1.1</b> Pareto</a></li>
<li class="chapter" data-level="3.4.1.2" data-path="return-distributions.html"><a href="return-distributions.html#standard-cauchy"><i class="fa fa-check"></i><b>3.4.1.2</b> Standard Cauchy</a></li>
<li class="chapter" data-level="3.4.1.3" data-path="return-distributions.html"><a href="return-distributions.html#students-t"><i class="fa fa-check"></i><b>3.4.1.3</b> Students t</a></li>
</ul></li>
<li class="chapter" data-level="3.4.2" data-path="return-distributions.html"><a href="return-distributions.html#stable-distributions"><i class="fa fa-check"></i><b>3.4.2</b> Stable Distributions</a>
<ul>
<li class="chapter" data-level="3.4.2.1" data-path="return-distributions.html"><a href="return-distributions.html#generalized-central-limit-theorem"><i class="fa fa-check"></i><b>3.4.2.1</b> Generalized Central Limit Theorem</a></li>
<li class="chapter" data-level="3.4.2.2" data-path="return-distributions.html"><a href="return-distributions.html#measuring-tail-behaviour"><i class="fa fa-check"></i><b>3.4.2.2</b> Measuring tail behaviour</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="return-distributions.html"><a href="return-distributions.html#mixture-distributions"><i class="fa fa-check"></i><b>3.5</b> Mixture Distributions</a>
<ul>
<li class="chapter" data-level="3.5.0.1" data-path="return-distributions.html"><a href="return-distributions.html#normal-scale-mixture"><i class="fa fa-check"></i><b>3.5.0.1</b> Normal scale mixture</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html"><i class="fa fa-check"></i><b>4</b> Modelling Extreme Events</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#stylized-facts"><i class="fa fa-check"></i><b>4.1</b> Stylized Facts</a></li>
<li class="chapter" data-level="4.2" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#extreme-value-theory"><i class="fa fa-check"></i><b>4.2</b> Extreme Value Theory</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#two-main-results"><i class="fa fa-check"></i><b>4.2.1</b> Two main results</a></li>
<li class="chapter" data-level="4.2.2" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#st-theorem-fisher-tippet-gnedenko"><i class="fa fa-check"></i><b>4.2.2</b> 1st Theorem: Fisher-Tippet-Gnedenko</a></li>
<li class="chapter" data-level="4.2.3" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#generalized-extreme-value-gev-distribution"><i class="fa fa-check"></i><b>4.2.3</b> Generalized Extreme Value (GEV) Distribution</a></li>
<li class="chapter" data-level="4.2.4" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#nd-theorem-pickands-balkema-de-haan"><i class="fa fa-check"></i><b>4.2.4</b> 2nd Theorem: Pickands-Balkema-De Haan</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-return-modelling.html"><a href="multivariate-return-modelling.html"><i class="fa fa-check"></i><b>5</b> Multivariate Return Modelling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multivariate-return-modelling.html"><a href="multivariate-return-modelling.html#covariance-correlation-matrix"><i class="fa fa-check"></i><b>5.1</b> Covariance &amp; Correlation Matrix</a></li>
<li class="chapter" data-level="5.2" data-path="multivariate-return-modelling.html"><a href="multivariate-return-modelling.html#multivariate-students-t-distribution"><i class="fa fa-check"></i><b>5.2</b> Multivariate Student’s t Distribution</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="copulas.html"><a href="copulas.html"><i class="fa fa-check"></i><b>6</b> Copulas</a>
<ul>
<li class="chapter" data-level="6.1" data-path="copulas.html"><a href="copulas.html#the-independence-copula"><i class="fa fa-check"></i><b>6.1</b> The independence copula</a></li>
<li class="chapter" data-level="6.2" data-path="copulas.html"><a href="copulas.html#sklars-theorem"><i class="fa fa-check"></i><b>6.2</b> Sklar’s Theorem</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="copulas.html"><a href="copulas.html#example"><i class="fa fa-check"></i><b>6.2.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="copulas.html"><a href="copulas.html#gaussian-copula"><i class="fa fa-check"></i><b>6.3</b> Gaussian Copula</a></li>
<li class="chapter" data-level="6.4" data-path="copulas.html"><a href="copulas.html#creating-copulas-from-multivariate-distributions"><i class="fa fa-check"></i><b>6.4</b> Creating Copula’s from Multivariate Distributions</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="copulas.html"><a href="copulas.html#copula-example-plots"><i class="fa fa-check"></i><b>6.4.1</b> Copula example plots</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="copulas.html"><a href="copulas.html#elliptical-copulas"><i class="fa fa-check"></i><b>6.5</b> Elliptical Copulas</a></li>
<li class="chapter" data-level="6.6" data-path="copulas.html"><a href="copulas.html#archimedean-copulas"><i class="fa fa-check"></i><b>6.6</b> Archimedean Copulas</a></li>
<li class="chapter" data-level="6.7" data-path="copulas.html"><a href="copulas.html#fitting-copulas"><i class="fa fa-check"></i><b>6.7</b> Fitting Copula’s</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="portfolio-theory.html"><a href="portfolio-theory.html"><i class="fa fa-check"></i><b>7</b> Portfolio Theory</a>
<ul>
<li class="chapter" data-level="7.1" data-path="portfolio-theory.html"><a href="portfolio-theory.html#assumptions"><i class="fa fa-check"></i><b>7.1</b> Assumptions</a></li>
<li class="chapter" data-level="7.2" data-path="portfolio-theory.html"><a href="portfolio-theory.html#dealing-with-two-assets"><i class="fa fa-check"></i><b>7.2</b> Dealing with Two Assets</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="portfolio-theory.html"><a href="portfolio-theory.html#portfolio-return"><i class="fa fa-check"></i><b>7.2.1</b> Portfolio Return</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="portfolio-theory.html"><a href="portfolio-theory.html#efficiency-frontier"><i class="fa fa-check"></i><b>7.3</b> Efficiency frontier</a></li>
<li class="chapter" data-level="7.4" data-path="portfolio-theory.html"><a href="portfolio-theory.html#multiple-asset-portfolio"><i class="fa fa-check"></i><b>7.4</b> Multiple asset portfolio</a></li>
<li class="chapter" data-level="7.5" data-path="portfolio-theory.html"><a href="portfolio-theory.html#capm---capital-asset-pricing-model"><i class="fa fa-check"></i><b>7.5</b> CAPM - Capital Asset Pricing Model</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="portfolio-theory.html"><a href="portfolio-theory.html#market-portfolio"><i class="fa fa-check"></i><b>7.5.1</b> Market Portfolio</a></li>
<li class="chapter" data-level="7.5.2" data-path="portfolio-theory.html"><a href="portfolio-theory.html#capital-market-line"><i class="fa fa-check"></i><b>7.5.2</b> Capital Market Line</a></li>
<li class="chapter" data-level="7.5.3" data-path="portfolio-theory.html"><a href="portfolio-theory.html#security-market-line"><i class="fa fa-check"></i><b>7.5.3</b> Security Market Line</a>
<ul>
<li class="chapter" data-level="7.5.3.1" data-path="portfolio-theory.html"><a href="portfolio-theory.html#ex-find-market-portfolio-weights-and-sml-with-n-i.i.d-assets"><i class="fa fa-check"></i><b>7.5.3.1</b> Ex: Find market portfolio weights and SML with <span class="math inline">\(N\)</span> i.i.d assets</a></li>
</ul></li>
<li class="chapter" data-level="7.5.4" data-path="portfolio-theory.html"><a href="portfolio-theory.html#security-characteristic-line"><i class="fa fa-check"></i><b>7.5.4</b> Security Characteristic Line</a>
<ul>
<li class="chapter" data-level="7.5.4.1" data-path="portfolio-theory.html"><a href="portfolio-theory.html#alpha-beta"><i class="fa fa-check"></i><b>7.5.4.1</b> Alpha &amp; Beta</a></li>
</ul></li>
<li class="chapter" data-level="7.5.5" data-path="portfolio-theory.html"><a href="portfolio-theory.html#legacy-of-capm"><i class="fa fa-check"></i><b>7.5.5</b> Legacy of CAPM</a></li>
<li class="chapter" data-level="7.5.6" data-path="portfolio-theory.html"><a href="portfolio-theory.html#performance-evaluation"><i class="fa fa-check"></i><b>7.5.6</b> Performance Evaluation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="factor-models.html"><a href="factor-models.html"><i class="fa fa-check"></i><b>8</b> Factor Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="factor-models.html"><a href="factor-models.html#three-factor-models"><i class="fa fa-check"></i><b>8.1</b> Three Factor models</a></li>
<li class="chapter" data-level="8.2" data-path="factor-models.html"><a href="factor-models.html#factor-model-assumptions"><i class="fa fa-check"></i><b>8.2</b> Factor Model Assumptions</a></li>
<li class="chapter" data-level="8.3" data-path="factor-models.html"><a href="factor-models.html#time-series-regression-models"><i class="fa fa-check"></i><b>8.3</b> Time Series Regression Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="factor-models.html"><a href="factor-models.html#fama-french-3-factor-model"><i class="fa fa-check"></i><b>8.3.1</b> Fama-French 3 Factor Model</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="factor-models.html"><a href="factor-models.html#statistical-factor-models"><i class="fa fa-check"></i><b>8.4</b> Statistical Factor Models</a></li>
<li class="chapter" data-level="8.5" data-path="factor-models.html"><a href="factor-models.html#principle-component-analysis-pca"><i class="fa fa-check"></i><b>8.5</b> Principle Component Analysis (PCA)</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="factor-models.html"><a href="factor-models.html#selecting-components"><i class="fa fa-check"></i><b>8.5.1</b> Selecting Components</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="factor-models.html"><a href="factor-models.html#factor-analysis"><i class="fa fa-check"></i><b>8.6</b> Factor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="risk-measures.html"><a href="risk-measures.html"><i class="fa fa-check"></i><b>9</b> Risk Measures</a>
<ul>
<li class="chapter" data-level="9.1" data-path="risk-measures.html"><a href="risk-measures.html#formulas"><i class="fa fa-check"></i><b>9.1</b> Formulas</a></li>
<li class="chapter" data-level="9.2" data-path="risk-measures.html"><a href="risk-measures.html#value-at-risk-var"><i class="fa fa-check"></i><b>9.2</b> Value At Risk (VAR)</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="risk-measures.html"><a href="risk-measures.html#example-1"><i class="fa fa-check"></i><b>9.2.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="risk-measures.html"><a href="risk-measures.html#var-hides-tail-risk"><i class="fa fa-check"></i><b>9.3</b> VaR hides tail risk</a>
<ul>
<li class="chapter" data-level="9.3.0.1" data-path="risk-measures.html"><a href="risk-measures.html#mitigation-cond-var-or-expected-shortfall"><i class="fa fa-check"></i><b>9.3.0.1</b> Mitigation: Cond VaR or Expected Shortfall</a></li>
<li class="chapter" data-level="9.3.0.2" data-path="risk-measures.html"><a href="risk-measures.html#example-2"><i class="fa fa-check"></i><b>9.3.0.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="risk-measures.html"><a href="risk-measures.html#risk-measure-properties"><i class="fa fa-check"></i><b>9.4</b> Risk Measure Properties</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="risk-measures.html"><a href="risk-measures.html#example-that-var-and-cvar-satisfy-prop-2-3"><i class="fa fa-check"></i><b>9.4.1</b> Example that VAR and CVar satisfy prop 2 &amp; 3</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="risk-measures.html"><a href="risk-measures.html#entropic-var"><i class="fa fa-check"></i><b>9.5</b> Entropic VaR</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="risk-measures.html"><a href="risk-measures.html#evar-for-a-normal-distribution"><i class="fa fa-check"></i><b>9.5.1</b> EVaR for a Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="risk-measures.html"><a href="risk-measures.html#calculating-risk-measures"><i class="fa fa-check"></i><b>9.6</b> Calculating Risk Measures</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="betting-strategies.html"><a href="betting-strategies.html"><i class="fa fa-check"></i><b>10</b> Betting Strategies</a>
<ul>
<li class="chapter" data-level="10.1" data-path="betting-strategies.html"><a href="betting-strategies.html#problem-setup"><i class="fa fa-check"></i><b>10.1</b> Problem Setup</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="betting-strategies.html"><a href="betting-strategies.html#scenario-1-bet-fixed-amount"><i class="fa fa-check"></i><b>10.1.1</b> Scenario 1: Bet fixed amount</a>
<ul>
<li class="chapter" data-level="10.1.1.1" data-path="betting-strategies.html"><a href="betting-strategies.html#hidden-probability-of-ruin"><i class="fa fa-check"></i><b>10.1.1.1</b> Hidden probability of ruin</a></li>
</ul></li>
<li class="chapter" data-level="10.1.2" data-path="betting-strategies.html"><a href="betting-strategies.html#scenario-2-bet-entire-wealth"><i class="fa fa-check"></i><b>10.1.2</b> Scenario 2: Bet entire wealth</a></li>
<li class="chapter" data-level="10.1.3" data-path="betting-strategies.html"><a href="betting-strategies.html#scenario-3-exp-growth-wo-ruin"><i class="fa fa-check"></i><b>10.1.3</b> Scenario 3: Exp growth w/o ruin</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="betting-strategies.html"><a href="betting-strategies.html#kelly-criterion"><i class="fa fa-check"></i><b>10.2</b> Kelly Criterion</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="betting-strategies.html"><a href="betting-strategies.html#finding-the-optimal-value"><i class="fa fa-check"></i><b>10.2.1</b> Finding the Optimal Value</a></li>
<li class="chapter" data-level="10.2.2" data-path="betting-strategies.html"><a href="betting-strategies.html#geometric-average"><i class="fa fa-check"></i><b>10.2.2</b> Geometric average</a></li>
<li class="chapter" data-level="10.2.3" data-path="betting-strategies.html"><a href="betting-strategies.html#simple-example"><i class="fa fa-check"></i><b>10.2.3</b> Simple example</a></li>
<li class="chapter" data-level="10.2.4" data-path="betting-strategies.html"><a href="betting-strategies.html#kelly-criterion-in-investing"><i class="fa fa-check"></i><b>10.2.4</b> Kelly Criterion in Investing</a>
<ul>
<li class="chapter" data-level="10.2.4.1" data-path="betting-strategies.html"><a href="betting-strategies.html#example-in-investing"><i class="fa fa-check"></i><b>10.2.4.1</b> Example in investing</a></li>
</ul></li>
<li class="chapter" data-level="10.2.5" data-path="betting-strategies.html"><a href="betting-strategies.html#theoretical-properties"><i class="fa fa-check"></i><b>10.2.5</b> Theoretical properties</a></li>
<li class="chapter" data-level="10.2.6" data-path="betting-strategies.html"><a href="betting-strategies.html#criticisms"><i class="fa fa-check"></i><b>10.2.6</b> Criticisms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html"><i class="fa fa-check"></i><b>11</b> Statistical Arbitrage</a>
<ul>
<li class="chapter" data-level="11.1" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#pairs-trading"><i class="fa fa-check"></i><b>11.1</b> Pairs Trading</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#what-could-go-wrong"><i class="fa fa-check"></i><b>11.1.1</b> What could go wrong</a></li>
<li class="chapter" data-level="11.1.2" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#other-things-to-consider"><i class="fa fa-check"></i><b>11.1.2</b> Other things to consider</a>
<ul>
<li class="chapter" data-level="11.1.2.1" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#determining-which-pairs-to-trade"><i class="fa fa-check"></i><b>11.1.2.1</b> 1. Determining which pairs to trade</a></li>
<li class="chapter" data-level="11.1.2.2" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#example-1-log"><i class="fa fa-check"></i><b>11.1.2.2</b> Example 1: Log</a></li>
<li class="chapter" data-level="11.1.2.3" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#example-2-bm"><i class="fa fa-check"></i><b>11.1.2.3</b> Example 2: BM</a></li>
</ul></li>
<li class="chapter" data-level="11.1.3" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#mean-reversion"><i class="fa fa-check"></i><b>11.1.3</b> Mean Reversion</a></li>
<li class="chapter" data-level="11.1.4" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#integrated-series"><i class="fa fa-check"></i><b>11.1.4</b> Integrated Series</a></li>
<li class="chapter" data-level="11.1.5" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#cointegration"><i class="fa fa-check"></i><b>11.1.5</b> Cointegration</a>
<ul>
<li class="chapter" data-level="11.1.5.1" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#ex-yield-rate"><i class="fa fa-check"></i><b>11.1.5.1</b> Ex: Yield Rate</a></li>
<li class="chapter" data-level="11.1.5.2" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#ex-math"><i class="fa fa-check"></i><b>11.1.5.2</b> Ex: Math</a></li>
</ul></li>
<li class="chapter" data-level="11.1.6" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#stationarity"><i class="fa fa-check"></i><b>11.1.6</b> Stationarity</a>
<ul>
<li class="chapter" data-level="11.1.6.1" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#tests"><i class="fa fa-check"></i><b>11.1.6.1</b> Tests</a></li>
<li class="chapter" data-level="11.1.6.2" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#two-step-method-example"><i class="fa fa-check"></i><b>11.1.6.2</b> Two step method example</a></li>
</ul></li>
<li class="chapter" data-level="11.1.7" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#spurious-regression"><i class="fa fa-check"></i><b>11.1.7</b> Spurious regression</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#financial-indices"><i class="fa fa-check"></i><b>11.2</b> Financial Indices</a></li>
<li class="chapter" data-level="11.3" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#index-arbitrage"><i class="fa fa-check"></i><b>11.3</b> Index Arbitrage</a></li>
<li class="chapter" data-level="11.4" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#volatility-arbitrage"><i class="fa fa-check"></i><b>11.4</b> Volatility Arbitrage</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#e.g.-delta-hedged-long-call"><i class="fa fa-check"></i><b>11.4.1</b> E.g. Delta-hedged long call</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="statistical-arbitrage.html"><a href="statistical-arbitrage.html#high-frequency-trading"><i class="fa fa-check"></i><b>11.5</b> High Frequency Trading</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html"><i class="fa fa-check"></i><b>12</b> Monte-Carlo Simulation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#brownian-motion"><i class="fa fa-check"></i><b>12.1</b> Brownian Motion</a></li>
<li class="chapter" data-level="12.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#properties-of-the-multivariate-normal"><i class="fa fa-check"></i><b>12.2</b> Properties of the Multivariate Normal</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#ex-distribution-given-x_s"><i class="fa fa-check"></i><b>12.2.1</b> Ex: Distribution given X_s</a></li>
<li class="chapter" data-level="12.2.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#ex-brownian-bridge-distribution-given-x_t"><i class="fa fa-check"></i><b>12.2.2</b> Ex: Brownian Bridge (Distribution given X_t)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#geometric-brownian-motion"><i class="fa fa-check"></i><b>12.3</b> Geometric Brownian Motion</a></li>
<li class="chapter" data-level="12.4" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#risk-neutral-pricing"><i class="fa fa-check"></i><b>12.4</b> Risk-Neutral Pricing</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#ex-rn-pricing"><i class="fa fa-check"></i><b>12.4.1</b> Ex: RN Pricing</a></li>
<li class="chapter" data-level="12.4.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#ex-find-price-of-forward-contract-no-dividends"><i class="fa fa-check"></i><b>12.4.2</b> Ex: Find price of forward contract (no dividends)</a></li>
<li class="chapter" data-level="12.4.3" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#estimating-expectations"><i class="fa fa-check"></i><b>12.4.3</b> Estimating Expectations</a></li>
<li class="chapter" data-level="12.4.4" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#ex-show-estimator-is-consistent"><i class="fa fa-check"></i><b>12.4.4</b> Ex: Show estimator is consistent</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#european-call"><i class="fa fa-check"></i><b>12.5</b> European Call</a></li>
<li class="chapter" data-level="12.6" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#multiple-assets"><i class="fa fa-check"></i><b>12.6</b> Multiple Assets</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#multivariate-brownian-motion"><i class="fa fa-check"></i><b>12.6.1</b> Multivariate Brownian Motion</a></li>
<li class="chapter" data-level="12.6.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#multivariate-arithmetic-bm"><i class="fa fa-check"></i><b>12.6.2</b> Multivariate Arithmetic BM</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#cholesky-factorization"><i class="fa fa-check"></i><b>12.7</b> Cholesky Factorization</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#example-3"><i class="fa fa-check"></i><b>12.7.1</b> Example</a></li>
<li class="chapter" data-level="12.7.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#multivariate-geometric-bm"><i class="fa fa-check"></i><b>12.7.2</b> Multivariate Geometric BM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html"><i class="fa fa-check"></i><b>13</b> Pricing Derivatives</a>
<ul>
<li class="chapter" data-level="13.1" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#path-dependent-options"><i class="fa fa-check"></i><b>13.1</b> Path Dependent Options</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#barrier-options"><i class="fa fa-check"></i><b>13.1.1</b> Barrier Options</a>
<ul>
<li class="chapter" data-level="13.1.1.1" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#example-4"><i class="fa fa-check"></i><b>13.1.1.1</b> Example</a></li>
<li class="chapter" data-level="13.1.1.2" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#barrier-options-only-depend-on-minmax"><i class="fa fa-check"></i><b>13.1.1.2</b> Barrier options only depend on min/max</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#simulating-geometric-brownian-motion-gbm-paths"><i class="fa fa-check"></i><b>13.2</b> Simulating Geometric Brownian Motion (GBM) Paths</a></li>
<li class="chapter" data-level="13.3" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#monte-carlo-for-barrier-options"><i class="fa fa-check"></i><b>13.3</b> Monte Carlo for Barrier Options</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#example-find-maximum-by-time-t"><i class="fa fa-check"></i><b>13.3.1</b> Example: Find maximum by time T</a></li>
<li class="chapter" data-level="13.3.2" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#example-find-prob-of-w_t-hitting-barrier-b-by-time-t"><i class="fa fa-check"></i><b>13.3.2</b> Example: Find Prob of W_T hitting barrier B by time T</a>
<ul>
<li class="chapter" data-level="13.3.2.1" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#by-simulation"><i class="fa fa-check"></i><b>13.3.2.1</b> By simulation</a></li>
</ul></li>
<li class="chapter" data-level="13.3.3" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#example-mc-simulation-wo-bias"><i class="fa fa-check"></i><b>13.3.3</b> Example: MC Simulation w/o bias</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#extrema-of-brownian-motion"><i class="fa fa-check"></i><b>13.4</b> Extrema of Brownian Motion</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#procedure-to-generate-maxima"><i class="fa fa-check"></i><b>13.4.1</b> Procedure to generate maxima</a></li>
<li class="chapter" data-level="13.4.2" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#example-uo-call"><i class="fa fa-check"></i><b>13.4.2</b> Example: U&amp;O Call</a></li>
<li class="chapter" data-level="13.4.3" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#example-simulate-minimum-of-arithmetic-bm-based-on-max"><i class="fa fa-check"></i><b>13.4.3</b> Example: Simulate minimum of arithmetic BM based on max</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#time-discretization"><i class="fa fa-check"></i><b>13.5</b> Time Discretization</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="pricing-derivatives.html"><a href="pricing-derivatives.html#euler-discretization"><i class="fa fa-check"></i><b>13.5.1</b> Euler Discretization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="variance-reduction.html"><a href="variance-reduction.html"><i class="fa fa-check"></i><b>14</b> Variance Reduction</a>
<ul>
<li class="chapter" data-level="14.1" data-path="variance-reduction.html"><a href="variance-reduction.html#techniques"><i class="fa fa-check"></i><b>14.1</b> Techniques</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="variance-reduction.html"><a href="variance-reduction.html#antithetic-variables"><i class="fa fa-check"></i><b>14.1.1</b> Antithetic Variables</a></li>
<li class="chapter" data-level="14.1.2" data-path="variance-reduction.html"><a href="variance-reduction.html#stratification"><i class="fa fa-check"></i><b>14.1.2</b> Stratification</a></li>
<li class="chapter" data-level="14.1.3" data-path="variance-reduction.html"><a href="variance-reduction.html#control-variates"><i class="fa fa-check"></i><b>14.1.3</b> Control Variates</a>
<ul>
<li class="chapter" data-level="14.1.3.1" data-path="variance-reduction.html"><a href="variance-reduction.html#example-5"><i class="fa fa-check"></i><b>14.1.3.1</b> Example</a></li>
<li class="chapter" data-level="14.1.3.2" data-path="variance-reduction.html"><a href="variance-reduction.html#example-6"><i class="fa fa-check"></i><b>14.1.3.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="14.1.4" data-path="variance-reduction.html"><a href="variance-reduction.html#importance-sampling"><i class="fa fa-check"></i><b>14.1.4</b> Importance Sampling</a>
<ul>
<li class="chapter" data-level="14.1.4.1" data-path="variance-reduction.html"><a href="variance-reduction.html#importance-sampling-is-unbiased"><i class="fa fa-check"></i><b>14.1.4.1</b> Importance Sampling is unbiased</a></li>
<li class="chapter" data-level="14.1.4.2" data-path="variance-reduction.html"><a href="variance-reduction.html#extending-to-paths"><i class="fa fa-check"></i><b>14.1.4.2</b> Extending to paths</a></li>
</ul></li>
<li class="chapter" data-level="14.1.5" data-path="variance-reduction.html"><a href="variance-reduction.html#ex.-deep-ootm-european-call"><i class="fa fa-check"></i><b>14.1.5</b> Ex. Deep OOTM European Call</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>15</b> Optimization</a>
<ul>
<li class="chapter" data-level="15.1" data-path="optimization.html"><a href="optimization.html#role-optimization"><i class="fa fa-check"></i><b>15.1</b> Role Optimization</a></li>
<li class="chapter" data-level="15.2" data-path="optimization.html"><a href="optimization.html#types-of-optimization"><i class="fa fa-check"></i><b>15.2</b> Types of Optimization</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="optimization.html"><a href="optimization.html#example-7"><i class="fa fa-check"></i><b>15.2.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="optimization.html"><a href="optimization.html#stochastic-optimization"><i class="fa fa-check"></i><b>15.3</b> Stochastic Optimization</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="optimization.html"><a href="optimization.html#example-8"><i class="fa fa-check"></i><b>15.3.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="problem-set-1.html"><a href="problem-set-1.html"><i class="fa fa-check"></i><b>16</b> Problem Set 1</a>
<ul>
<li class="chapter" data-level="16.1" data-path="problem-set-1.html"><a href="problem-set-1.html#q1"><i class="fa fa-check"></i><b>16.1</b> Q1</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="problem-set-1.html"><a href="problem-set-1.html#data-prep"><i class="fa fa-check"></i><b>16.1.1</b> Data Prep</a></li>
<li class="chapter" data-level="16.1.2" data-path="problem-set-1.html"><a href="problem-set-1.html#plot"><i class="fa fa-check"></i><b>16.1.2</b> Plot</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="problem-set-1.html"><a href="problem-set-1.html#q2"><i class="fa fa-check"></i><b>16.2</b> Q2</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="problem-set-1.html"><a href="problem-set-1.html#a"><i class="fa fa-check"></i><b>16.2.1</b> 2.a</a></li>
<li class="chapter" data-level="16.2.2" data-path="problem-set-1.html"><a href="problem-set-1.html#b"><i class="fa fa-check"></i><b>16.2.2</b> 2.b</a></li>
<li class="chapter" data-level="16.2.3" data-path="problem-set-1.html"><a href="problem-set-1.html#c"><i class="fa fa-check"></i><b>16.2.3</b> 2.c</a></li>
<li class="chapter" data-level="16.2.4" data-path="problem-set-1.html"><a href="problem-set-1.html#d"><i class="fa fa-check"></i><b>16.2.4</b> 2.d</a></li>
<li class="chapter" data-level="16.2.5" data-path="problem-set-1.html"><a href="problem-set-1.html#e"><i class="fa fa-check"></i><b>16.2.5</b> 2.e</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="problem-set-1.html"><a href="problem-set-1.html#q3"><i class="fa fa-check"></i><b>16.3</b> Q3</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="problem-set-1.html"><a href="problem-set-1.html#mean-of-daily-log-return"><i class="fa fa-check"></i><b>16.3.1</b> Mean of daily log-return</a></li>
<li class="chapter" data-level="16.3.2" data-path="problem-set-1.html"><a href="problem-set-1.html#volatility-of-daily-log-return"><i class="fa fa-check"></i><b>16.3.2</b> Volatility of daily log-return</a></li>
<li class="chapter" data-level="16.3.3" data-path="problem-set-1.html"><a href="problem-set-1.html#plot-1"><i class="fa fa-check"></i><b>16.3.3</b> Plot</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="problem-set-1.html"><a href="problem-set-1.html#q4"><i class="fa fa-check"></i><b>16.4</b> Q4</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="problem-set-1.html"><a href="problem-set-1.html#a-1"><i class="fa fa-check"></i><b>16.4.1</b> 4.a</a></li>
<li class="chapter" data-level="16.4.2" data-path="problem-set-1.html"><a href="problem-set-1.html#b-1"><i class="fa fa-check"></i><b>16.4.2</b> 4.b</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="problem-set-2.html"><a href="problem-set-2.html"><i class="fa fa-check"></i><b>17</b> Problem Set 2</a>
<ul>
<li class="chapter" data-level="17.1" data-path="problem-set-2.html"><a href="problem-set-2.html#q1-1"><i class="fa fa-check"></i><b>17.1</b> Q1</a></li>
<li class="chapter" data-level="17.2" data-path="problem-set-2.html"><a href="problem-set-2.html#q2-1"><i class="fa fa-check"></i><b>17.2</b> Q2</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="problem-set-2.html"><a href="problem-set-2.html#part-a"><i class="fa fa-check"></i><b>17.2.1</b> Part A</a></li>
<li class="chapter" data-level="17.2.2" data-path="problem-set-2.html"><a href="problem-set-2.html#part-b"><i class="fa fa-check"></i><b>17.2.2</b> Part B</a></li>
<li class="chapter" data-level="17.2.3" data-path="problem-set-2.html"><a href="problem-set-2.html#part-c"><i class="fa fa-check"></i><b>17.2.3</b> Part C</a></li>
<li class="chapter" data-level="17.2.4" data-path="problem-set-2.html"><a href="problem-set-2.html#part-d"><i class="fa fa-check"></i><b>17.2.4</b> Part D</a></li>
<li class="chapter" data-level="17.2.5" data-path="problem-set-2.html"><a href="problem-set-2.html#part-e"><i class="fa fa-check"></i><b>17.2.5</b> Part E</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="problem-set-2.html"><a href="problem-set-2.html#q3-1"><i class="fa fa-check"></i><b>17.3</b> Q3</a></li>
<li class="chapter" data-level="17.4" data-path="problem-set-2.html"><a href="problem-set-2.html#q4-1"><i class="fa fa-check"></i><b>17.4</b> Q4</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="problem-set-2.html"><a href="problem-set-2.html#part-a-1"><i class="fa fa-check"></i><b>17.4.1</b> Part A</a></li>
<li class="chapter" data-level="17.4.2" data-path="problem-set-2.html"><a href="problem-set-2.html#part-b-1"><i class="fa fa-check"></i><b>17.4.2</b> Part B</a></li>
<li class="chapter" data-level="17.4.3" data-path="problem-set-2.html"><a href="problem-set-2.html#part-c-1"><i class="fa fa-check"></i><b>17.4.3</b> Part C</a>
<ul>
<li class="chapter" data-level="17.4.3.1" data-path="problem-set-2.html"><a href="problem-set-2.html#part-i"><i class="fa fa-check"></i><b>17.4.3.1</b> Part i</a></li>
<li class="chapter" data-level="17.4.3.2" data-path="problem-set-2.html"><a href="problem-set-2.html#part-ii"><i class="fa fa-check"></i><b>17.4.3.2</b> Part ii</a></li>
<li class="chapter" data-level="17.4.3.3" data-path="problem-set-2.html"><a href="problem-set-2.html#part-iii"><i class="fa fa-check"></i><b>17.4.3.3</b> Part iii</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="problem-set-2.html"><a href="problem-set-2.html#q5"><i class="fa fa-check"></i><b>17.5</b> Q5</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="problem-set-2.html"><a href="problem-set-2.html#part-a-2"><i class="fa fa-check"></i><b>17.5.1</b> Part A</a></li>
<li class="chapter" data-level="17.5.2" data-path="problem-set-2.html"><a href="problem-set-2.html#part-b-2"><i class="fa fa-check"></i><b>17.5.2</b> Part B</a></li>
<li class="chapter" data-level="17.5.3" data-path="problem-set-2.html"><a href="problem-set-2.html#part-c-2"><i class="fa fa-check"></i><b>17.5.3</b> Part C</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="problem-set-3.html"><a href="problem-set-3.html"><i class="fa fa-check"></i><b>18</b> Problem Set 3</a>
<ul>
<li class="chapter" data-level="18.1" data-path="problem-set-3.html"><a href="problem-set-3.html#q1-2"><i class="fa fa-check"></i><b>18.1</b> Q1</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="problem-set-3.html"><a href="problem-set-3.html#part-a-3"><i class="fa fa-check"></i><b>18.1.1</b> Part A</a></li>
<li class="chapter" data-level="18.1.2" data-path="problem-set-3.html"><a href="problem-set-3.html#part-b-3"><i class="fa fa-check"></i><b>18.1.2</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="problem-set-3.html"><a href="problem-set-3.html#q2-2"><i class="fa fa-check"></i><b>18.2</b> Q2</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="problem-set-3.html"><a href="problem-set-3.html#part-a-4"><i class="fa fa-check"></i><b>18.2.1</b> Part A</a></li>
<li class="chapter" data-level="18.2.2" data-path="problem-set-3.html"><a href="problem-set-3.html#part-b-4"><i class="fa fa-check"></i><b>18.2.2</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="problem-set-3.html"><a href="problem-set-3.html#q3-2"><i class="fa fa-check"></i><b>18.3</b> Q3</a></li>
<li class="chapter" data-level="18.4" data-path="problem-set-3.html"><a href="problem-set-3.html#q4-2"><i class="fa fa-check"></i><b>18.4</b> Q4</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="problem-set-4.html"><a href="problem-set-4.html"><i class="fa fa-check"></i><b>19</b> Problem Set 4</a>
<ul>
<li class="chapter" data-level="19.1" data-path="problem-set-4.html"><a href="problem-set-4.html#q1.1"><i class="fa fa-check"></i><b>19.1</b> Q1.1</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="problem-set-4.html"><a href="problem-set-4.html#part-a-5"><i class="fa fa-check"></i><b>19.1.1</b> Part A</a></li>
<li class="chapter" data-level="19.1.2" data-path="problem-set-4.html"><a href="problem-set-4.html#part-b-5"><i class="fa fa-check"></i><b>19.1.2</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="problem-set-4.html"><a href="problem-set-4.html#q1.2"><i class="fa fa-check"></i><b>19.2</b> Q1.2</a></li>
<li class="chapter" data-level="19.3" data-path="problem-set-4.html"><a href="problem-set-4.html#q1.3"><i class="fa fa-check"></i><b>19.3</b> Q1.3</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="problem-set-4.html"><a href="problem-set-4.html#part-a-6"><i class="fa fa-check"></i><b>19.3.1</b> Part A</a></li>
<li class="chapter" data-level="19.3.2" data-path="problem-set-4.html"><a href="problem-set-4.html#part-b-6"><i class="fa fa-check"></i><b>19.3.2</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="problem-set-4.html"><a href="problem-set-4.html#q1.4"><i class="fa fa-check"></i><b>19.4</b> Q1.4</a></li>
<li class="chapter" data-level="19.5" data-path="problem-set-4.html"><a href="problem-set-4.html#q2.1"><i class="fa fa-check"></i><b>19.5</b> Q2.1</a></li>
<li class="chapter" data-level="19.6" data-path="problem-set-4.html"><a href="problem-set-4.html#q2.2"><i class="fa fa-check"></i><b>19.6</b> Q2.2</a></li>
<li class="chapter" data-level="19.7" data-path="problem-set-4.html"><a href="problem-set-4.html#q2.3"><i class="fa fa-check"></i><b>19.7</b> Q2.3</a></li>
<li class="chapter" data-level="19.8" data-path="problem-set-4.html"><a href="problem-set-4.html#q3-3"><i class="fa fa-check"></i><b>19.8</b> Q3</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="problem-set-4.html"><a href="problem-set-4.html#part-a-7"><i class="fa fa-check"></i><b>19.8.1</b> Part A</a></li>
<li class="chapter" data-level="19.8.2" data-path="problem-set-4.html"><a href="problem-set-4.html#part-b-7"><i class="fa fa-check"></i><b>19.8.2</b> Part B</a></li>
<li class="chapter" data-level="19.8.3" data-path="problem-set-4.html"><a href="problem-set-4.html#part-c-3"><i class="fa fa-check"></i><b>19.8.3</b> Part C</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="problem-set-5.html"><a href="problem-set-5.html"><i class="fa fa-check"></i><b>20</b> Problem Set 5</a>
<ul>
<li class="chapter" data-level="20.1" data-path="problem-set-5.html"><a href="problem-set-5.html#q1-3"><i class="fa fa-check"></i><b>20.1</b> Q1</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="problem-set-5.html"><a href="problem-set-5.html#part-a-8"><i class="fa fa-check"></i><b>20.1.1</b> Part A</a></li>
<li class="chapter" data-level="20.1.2" data-path="problem-set-5.html"><a href="problem-set-5.html#lemma-for-special-inverse-covariance-matrices"><i class="fa fa-check"></i><b>20.1.2</b> Lemma for special inverse covariance matrices</a></li>
<li class="chapter" data-level="20.1.3" data-path="problem-set-5.html"><a href="problem-set-5.html#part-b-8"><i class="fa fa-check"></i><b>20.1.3</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="problem-set-5.html"><a href="problem-set-5.html#q2-3"><i class="fa fa-check"></i><b>20.2</b> Q2</a></li>
<li class="chapter" data-level="20.3" data-path="problem-set-5.html"><a href="problem-set-5.html#q3-4"><i class="fa fa-check"></i><b>20.3</b> Q3</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="problem-set-5.html"><a href="problem-set-5.html#part-a-9"><i class="fa fa-check"></i><b>20.3.1</b> Part A</a></li>
<li class="chapter" data-level="20.3.2" data-path="problem-set-5.html"><a href="problem-set-5.html#part-b-9"><i class="fa fa-check"></i><b>20.3.2</b> Part B</a></li>
<li class="chapter" data-level="20.3.3" data-path="problem-set-5.html"><a href="problem-set-5.html#part-c-4"><i class="fa fa-check"></i><b>20.3.3</b> Part C</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="problem-set-5.html"><a href="problem-set-5.html#q4-3"><i class="fa fa-check"></i><b>20.4</b> Q4</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="problem-set-5.html"><a href="problem-set-5.html#part-a-10"><i class="fa fa-check"></i><b>20.4.1</b> Part A</a></li>
<li class="chapter" data-level="20.4.2" data-path="problem-set-5.html"><a href="problem-set-5.html#part-b-10"><i class="fa fa-check"></i><b>20.4.2</b> Part B</a></li>
<li class="chapter" data-level="20.4.3" data-path="problem-set-5.html"><a href="problem-set-5.html#part-c-5"><i class="fa fa-check"></i><b>20.4.3</b> Part C</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="problem-set-6.html"><a href="problem-set-6.html"><i class="fa fa-check"></i><b>21</b> Problem Set 6</a>
<ul>
<li class="chapter" data-level="21.1" data-path="problem-set-6.html"><a href="problem-set-6.html#q1-4"><i class="fa fa-check"></i><b>21.1</b> Q1</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="problem-set-6.html"><a href="problem-set-6.html#part-a-11"><i class="fa fa-check"></i><b>21.1.1</b> Part A</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="problem-set-6.html"><a href="problem-set-6.html#q2-4"><i class="fa fa-check"></i><b>21.2</b> Q2</a></li>
<li class="chapter" data-level="21.3" data-path="problem-set-6.html"><a href="problem-set-6.html#q3-5"><i class="fa fa-check"></i><b>21.3</b> Q3</a></li>
<li class="chapter" data-level="21.4" data-path="problem-set-6.html"><a href="problem-set-6.html#q4-4"><i class="fa fa-check"></i><b>21.4</b> Q4</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="problem-set-6.html"><a href="problem-set-6.html#part-a-12"><i class="fa fa-check"></i><b>21.4.1</b> Part A</a></li>
<li class="chapter" data-level="21.4.2" data-path="problem-set-6.html"><a href="problem-set-6.html#part-b-11"><i class="fa fa-check"></i><b>21.4.2</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="problem-set-6.html"><a href="problem-set-6.html#q5-1"><i class="fa fa-check"></i><b>21.5</b> Q5</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="problem-set-6.html"><a href="problem-set-6.html#part-a-13"><i class="fa fa-check"></i><b>21.5.1</b> Part A</a></li>
<li class="chapter" data-level="21.5.2" data-path="problem-set-6.html"><a href="problem-set-6.html#part-b-12"><i class="fa fa-check"></i><b>21.5.2</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="problem-set-6.html"><a href="problem-set-6.html#q6"><i class="fa fa-check"></i><b>21.6</b> Q6</a></li>
<li class="chapter" data-level="21.7" data-path="problem-set-6.html"><a href="problem-set-6.html#q7"><i class="fa fa-check"></i><b>21.7</b> Q7</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="w2021-midterm.html"><a href="w2021-midterm.html"><i class="fa fa-check"></i><b>22</b> W2021 Midterm</a>
<ul>
<li class="chapter" data-level="22.1" data-path="w2021-midterm.html"><a href="w2021-midterm.html#q2-5"><i class="fa fa-check"></i><b>22.1</b> Q2</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="w2021-midterm.html"><a href="w2021-midterm.html#part-a-14"><i class="fa fa-check"></i><b>22.1.1</b> Part A</a></li>
<li class="chapter" data-level="22.1.2" data-path="w2021-midterm.html"><a href="w2021-midterm.html#part-b-13"><i class="fa fa-check"></i><b>22.1.2</b> Part B</a></li>
<li class="chapter" data-level="22.1.3" data-path="w2021-midterm.html"><a href="w2021-midterm.html#part-c-6"><i class="fa fa-check"></i><b>22.1.3</b> Part C</a></li>
<li class="chapter" data-level="22.1.4" data-path="w2021-midterm.html"><a href="w2021-midterm.html#part-d-1"><i class="fa fa-check"></i><b>22.1.4</b> Part D</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="w2020-midterm.html"><a href="w2020-midterm.html"><i class="fa fa-check"></i><b>23</b> W2020 Midterm</a>
<ul>
<li class="chapter" data-level="23.1" data-path="w2020-midterm.html"><a href="w2020-midterm.html#q3-6"><i class="fa fa-check"></i><b>23.1</b> Q3</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="w2020-midterm.html"><a href="w2020-midterm.html#part-a-15"><i class="fa fa-check"></i><b>23.1.1</b> Part A</a></li>
<li class="chapter" data-level="23.1.2" data-path="w2020-midterm.html"><a href="w2020-midterm.html#part-b-14"><i class="fa fa-check"></i><b>23.1.2</b> Part B</a></li>
<li class="chapter" data-level="23.1.3" data-path="w2020-midterm.html"><a href="w2020-midterm.html#part-c-7"><i class="fa fa-check"></i><b>23.1.3</b> Part C</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="w2020-midterm.html"><a href="w2020-midterm.html#q4-5"><i class="fa fa-check"></i><b>23.2</b> Q4</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="w2020-midterm.html"><a href="w2020-midterm.html#part-a-16"><i class="fa fa-check"></i><b>23.2.1</b> Part A</a>
<ul>
<li class="chapter" data-level="23.2.1.1" data-path="w2020-midterm.html"><a href="w2020-midterm.html#part-b-15"><i class="fa fa-check"></i><b>23.2.1.1</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="23.2.2" data-path="w2020-midterm.html"><a href="w2020-midterm.html#part-c-8"><i class="fa fa-check"></i><b>23.2.2</b> Part C</a></li>
<li class="chapter" data-level="23.2.3" data-path="w2020-midterm.html"><a href="w2020-midterm.html#part-d-2"><i class="fa fa-check"></i><b>23.2.3</b> Part D</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="cheatsheet.html"><a href="cheatsheet.html"><i class="fa fa-check"></i><b>24</b> Cheatsheet</a>
<ul>
<li class="chapter" data-level="24.1" data-path="cheatsheet.html"><a href="cheatsheet.html#probability"><i class="fa fa-check"></i><b>24.1</b> Probability</a></li>
<li class="chapter" data-level="24.2" data-path="cheatsheet.html"><a href="cheatsheet.html#math"><i class="fa fa-check"></i><b>24.2</b> Math</a></li>
<li class="chapter" data-level="24.3" data-path="cheatsheet.html"><a href="cheatsheet.html#series"><i class="fa fa-check"></i><b>24.3</b> Series</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="cheatsheet.html"><a href="cheatsheet.html#integrated-series-1"><i class="fa fa-check"></i><b>24.3.1</b> Integrated series</a></li>
<li class="chapter" data-level="24.3.2" data-path="cheatsheet.html"><a href="cheatsheet.html#cointegration-1"><i class="fa fa-check"></i><b>24.3.2</b> Cointegration</a></li>
<li class="chapter" data-level="24.3.3" data-path="cheatsheet.html"><a href="cheatsheet.html#brownian-motion-1"><i class="fa fa-check"></i><b>24.3.3</b> Brownian Motion</a></li>
<li class="chapter" data-level="24.3.4" data-path="cheatsheet.html"><a href="cheatsheet.html#arithmetic-bmrw"><i class="fa fa-check"></i><b>24.3.4</b> Arithmetic BM/RW</a></li>
<li class="chapter" data-level="24.3.5" data-path="cheatsheet.html"><a href="cheatsheet.html#geometric-brownian-motion-1"><i class="fa fa-check"></i><b>24.3.5</b> Geometric Brownian Motion</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="cheatsheet.html"><a href="cheatsheet.html#distributions"><i class="fa fa-check"></i><b>24.4</b> Distributions</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="cheatsheet.html"><a href="cheatsheet.html#multivariate-normal"><i class="fa fa-check"></i><b>24.4.1</b> Multivariate Normal</a></li>
<li class="chapter" data-level="24.4.2" data-path="cheatsheet.html"><a href="cheatsheet.html#heavy-tailed-distribution"><i class="fa fa-check"></i><b>24.4.2</b> Heavy-tailed distribution:</a></li>
<li class="chapter" data-level="24.4.3" data-path="cheatsheet.html"><a href="cheatsheet.html#stable-distribution"><i class="fa fa-check"></i><b>24.4.3</b> Stable Distribution:</a></li>
<li class="chapter" data-level="24.4.4" data-path="cheatsheet.html"><a href="cheatsheet.html#cauchy-distribution-t-distribution-with-1-df"><i class="fa fa-check"></i><b>24.4.4</b> Cauchy distribution (t distribution with 1 df):</a></li>
<li class="chapter" data-level="24.4.5" data-path="cheatsheet.html"><a href="cheatsheet.html#gamma-distribution"><i class="fa fa-check"></i><b>24.4.5</b> Gamma distribution:</a></li>
<li class="chapter" data-level="24.4.6" data-path="cheatsheet.html"><a href="cheatsheet.html#exponential-distribution"><i class="fa fa-check"></i><b>24.4.6</b> Exponential distribution:</a></li>
<li class="chapter" data-level="24.4.7" data-path="cheatsheet.html"><a href="cheatsheet.html#st-theorem-fisher-tippet-gnedenko-1"><i class="fa fa-check"></i><b>24.4.7</b> 1st Theorem: Fisher-Tippet-Gnedenko</a></li>
<li class="chapter" data-level="24.4.8" data-path="cheatsheet.html"><a href="cheatsheet.html#generalized-extreme-value-gev-distribution-1"><i class="fa fa-check"></i><b>24.4.8</b> Generalized Extreme Value (GEV) Distribution</a></li>
<li class="chapter" data-level="24.4.9" data-path="cheatsheet.html"><a href="cheatsheet.html#normal-scale-mixture-1"><i class="fa fa-check"></i><b>24.4.9</b> Normal scale mixture</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="cheatsheet.html"><a href="cheatsheet.html#copula"><i class="fa fa-check"></i><b>24.5</b> Copula</a></li>
<li class="chapter" data-level="24.6" data-path="cheatsheet.html"><a href="cheatsheet.html#portfolio-theory-1"><i class="fa fa-check"></i><b>24.6</b> Portfolio Theory</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="cheatsheet.html"><a href="cheatsheet.html#sharpe-ratio"><i class="fa fa-check"></i><b>24.6.1</b> Sharpe Ratio</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="cheatsheet.html"><a href="cheatsheet.html#factor-model"><i class="fa fa-check"></i><b>24.7</b> Factor Model</a>
<ul>
<li class="chapter" data-level="24.7.1" data-path="cheatsheet.html"><a href="cheatsheet.html#assumptions-1"><i class="fa fa-check"></i><b>24.7.1</b> Assumptions</a></li>
<li class="chapter" data-level="24.7.2" data-path="cheatsheet.html"><a href="cheatsheet.html#in-r"><i class="fa fa-check"></i><b>24.7.2</b> In R</a></li>
</ul></li>
<li class="chapter" data-level="24.8" data-path="cheatsheet.html"><a href="cheatsheet.html#risk-mgmt"><i class="fa fa-check"></i><b>24.8</b> Risk Mgmt</a>
<ul>
<li class="chapter" data-level="24.8.1" data-path="cheatsheet.html"><a href="cheatsheet.html#var"><i class="fa fa-check"></i><b>24.8.1</b> VaR</a></li>
<li class="chapter" data-level="24.8.2" data-path="cheatsheet.html"><a href="cheatsheet.html#conditional-var-cvar"><i class="fa fa-check"></i><b>24.8.2</b> Conditional VaR (CVaR)</a></li>
<li class="chapter" data-level="24.8.3" data-path="cheatsheet.html"><a href="cheatsheet.html#entropic-var-evar"><i class="fa fa-check"></i><b>24.8.3</b> Entropic VaR (EVaR)</a></li>
<li class="chapter" data-level="24.8.4" data-path="cheatsheet.html"><a href="cheatsheet.html#risk-measure-properties-1"><i class="fa fa-check"></i><b>24.8.4</b> Risk Measure Properties</a></li>
</ul></li>
<li class="chapter" data-level="24.9" data-path="cheatsheet.html"><a href="cheatsheet.html#betting-measures"><i class="fa fa-check"></i><b>24.9</b> Betting measures</a></li>
<li class="chapter" data-level="24.10" data-path="cheatsheet.html"><a href="cheatsheet.html#arbitrage"><i class="fa fa-check"></i><b>24.10</b> Arbitrage</a>
<ul>
<li class="chapter" data-level="24.10.1" data-path="cheatsheet.html"><a href="cheatsheet.html#pairs-trading-1"><i class="fa fa-check"></i><b>24.10.1</b> Pairs Trading</a></li>
</ul></li>
<li class="chapter" data-level="24.11" data-path="cheatsheet.html"><a href="cheatsheet.html#simulation"><i class="fa fa-check"></i><b>24.11</b> Simulation</a>
<ul>
<li class="chapter" data-level="24.11.1" data-path="cheatsheet.html"><a href="cheatsheet.html#simple-monte-carlo-estimator"><i class="fa fa-check"></i><b>24.11.1</b> Simple Monte Carlo estimator</a></li>
<li class="chapter" data-level="24.11.2" data-path="cheatsheet.html"><a href="cheatsheet.html#procedure-to-generate-maxima-1"><i class="fa fa-check"></i><b>24.11.2</b> Procedure to generate maxima</a></li>
<li class="chapter" data-level="24.11.3" data-path="cheatsheet.html"><a href="cheatsheet.html#risk-neutral-pricing-1"><i class="fa fa-check"></i><b>24.11.3</b> Risk Neutral Pricing</a></li>
<li class="chapter" data-level="24.11.4" data-path="cheatsheet.html"><a href="cheatsheet.html#black-scholes-european-call"><i class="fa fa-check"></i><b>24.11.4</b> Black Scholes European Call</a></li>
</ul></li>
<li class="chapter" data-level="24.12" data-path="cheatsheet.html"><a href="cheatsheet.html#variance-reduction-1"><i class="fa fa-check"></i><b>24.12</b> Variance Reduction</a>
<ul>
<li class="chapter" data-level="24.12.1" data-path="cheatsheet.html"><a href="cheatsheet.html#anti-thetic-variable"><i class="fa fa-check"></i><b>24.12.1</b> Anti-thetic Variable</a></li>
<li class="chapter" data-level="24.12.2" data-path="cheatsheet.html"><a href="cheatsheet.html#stratification-1"><i class="fa fa-check"></i><b>24.12.2</b> Stratification</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAD70 Course Work</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="variance-reduction" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> Variance Reduction<a href="variance-reduction.html#variance-reduction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Running simulation basically invokes SLLN. To sample the expectation of some RV <span class="math inline">\(Z\)</span>, we can sample a fixed <span class="math inline">\(n\)</span> variables and the sample means will converge to <span class="math inline">\(\mathbb{E}(Z)\)</span> at the rate <span class="math inline">\(\frac{1}{\sqrt{ n }}\sigma\)</span> (scaled by the variance).</p>
<p>We can converge faster simply by increase the number of samples, <strong>or we can decrease the variance</strong>. We’ll tackle the second method.</p>
<div id="techniques" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Techniques<a href="variance-reduction.html#techniques" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="antithetic-variables" class="section level3 hasAnchor" number="14.1.1">
<h3><span class="header-section-number">14.1.1</span> Antithetic Variables<a href="variance-reduction.html#antithetic-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Idea: For any Normal variate <span class="math inline">\(Z_{i}\)</span> consider it’s negative <span class="math inline">\(-Z_{i}\)</span>. (It will follow the same distribution, if it’s centered at 0. If not, you can shift it)</p>
<ul>
<li>They come from the same distribution, but are <em>dependent</em></li>
<li>Generally, for Uniform (0,1), use <span class="math inline">\(U_{i}\)</span> and <span class="math inline">\(1-U_{i}\)</span></li>
</ul>
<p>We can calculate the discounted payoff, denoted by <span class="math inline">\(Y\)</span> under both:
<span class="math display">\[
Y_{i} = f(Z_{i}), \tilde{Y}_{i} = \tilde{f}(-Z_{i})
\]</span></p>
<p>And then estimate price as
<span class="math display">\[
\bar{Y}_{AV} = \frac{1}{2n} \left( \sum^{n}_{i=1}Y_{i} + \sum^{n}_{i=1}\tilde{Y}_{i} \right) = \frac{1}{n}\sum^{n}_{i=1} \frac{Y_{i}+\tilde{Y}_{i}}{2}
\]</span></p>
<ul>
<li>Balance payoffs of paths with “opposite” returns.</li>
</ul>
<blockquote>
<p>Instead of generating many pseudo random numbers, just take the antithetic (negative) variable (faster)</p>
</blockquote>
<p>We can find the asymptotic distribution of antithetic variable estimator in terms of moments of <span class="math inline">\(\frac{Y_{i}+\tilde{Y}_{i}}{2}\)</span></p>
<p><span class="math display">\[
\begin{gathered}
\bar{Y}_{AN} \text{ is sample mean of iid } RV_i:\frac{Y_{i}+\tilde{Y}_{i}}{2}\\
\text{by CLT } \bar{Y_{AN}} \sim^{approx} N\left( \mathbb{E}\left[ \frac{Y_{i}+\tilde{Y}_{i}}{2} \right], \frac{1}{n} \mathbb{V}\left[ \frac{Y_{i}+\tilde{Y}_{i}}{2} \right] \right)\\
\end{gathered}
\]</span>
<span class="math display">\[
\begin{aligned}
\text{where } \mathbb{E}\left[ \frac{Y_{i}+\tilde{Y}_{i}}{2} \right] &amp;= \frac{1}{2}\left[ \mathbb{E}(Y_{i})+ \mathbb{E}(\tilde{Y}_{i}) \right] \\
&amp;= \frac{1}{2} 2 \mathbb{E}(Y) = \mathbb{E}\left(f(Z) \right) \\
\mathbb{V}\left[ \frac{Y_{i}+\tilde{Y}_{i}}{2} \right] &amp;= \frac{1}{n} \frac{1}{4}\left( \mathbb{V}[Y_{i}] + \underbrace{ \mathbb{V}[\tilde{Y}_{i}] }_{ =\mathbb{V}[Y_{i}] } + 2Cov(Y_{i},\tilde{Y}_{i})\right)\\
&amp;= \frac{1}{n} \frac{1}{4} \left( 2\mathbb{V}(Y_{i}) + 2 Cov(Y_{i}, \tilde{Y}_{i}) \right)\\
&amp;= \frac{1}{n} \frac{1}{2} \left( \mathbb{V}(Y_{i}) + Cov(Y_{i}, \tilde{Y}_{i}) \right)\\
\end{aligned}
\]</span></p>
<p>Antithetic variables may be simple and easy to generate but they won’t always help, although they will <strong>if the original and antithetic variables are negatively related. If they are unrelated/positively related, then you get worse results.</strong></p>
<blockquote>
<p>Using the antithetic variable vs Generating twice the number of samples</p>
</blockquote>
<p>Proof that <span class="math inline">\(\mathbb{V}[\bar{Y}_{AV}] &lt; \mathbb{V}\left[ \frac{1}{2n} \sum^{2n}_{i=1}Y_{i} \right]\)</span></p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{V}\left[ \frac{1}{2n} \sum^{2n}_{i=1}Y_{i} \right] &amp;= \frac{1}{2n} \mathbb{V}(Y)\\
\mathbb{V}[\bar{Y}_{AV}] &amp;= \frac{1}{2n}\cdot \left( \mathbb{V}(Y) + Cov(Y_{i}, \tilde{Y}_{i}) \right) \\
\left( \mathbb{V}(Y) + Cov(Y_{i}, \tilde{Y}_{i}) \right) &amp;\leq \mathbb{V}(Y) \text{ iff } Cov(Y_{i}, \tilde{Y}_{i}) \leq 0
\end{aligned}
\]</span></p>
<blockquote>
<p>This shows that the payoff is only worthwhile if <span class="math inline">\(f(Z)\)</span> is not an even function, as if it was, then <span class="math inline">\(\frac{Y_{i}+\tilde{Y}_{i}}{2}\)</span> would simply be <span class="math inline">\(Y_{i}\)</span> and that wouldn’t help us decrease varaince.</p>
</blockquote>
<p><img src="Notes/Obsidian-Attachments/12-Simulation-Variance-Reduction.png" /></p>
<blockquote>
<p>For a European call, using the antithetic variables will give us improved results because the payoff of the European call is not an even function.
There is an improvement in the accuracy of prediction using antithetic variables.</p>
</blockquote>
<blockquote>
<p>Antithetic variables are a very crude way of estimation, but it’s easy to program. It ensures that you have as many numbers on one side of the distribution as the other.</p>
</blockquote>
</div>
<div id="stratification" class="section level3 hasAnchor" number="14.1.2">
<h3><span class="header-section-number">14.1.2</span> Stratification<a href="variance-reduction.html#stratification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is inspired by statistical sampling.
Idea: Split RV domain into equi-probable strata and draw equal number of variates from within each one.</p>
<ul>
<li>E.g. (2 strata) draw equal number of independent positive and negative <span class="math inline">\(Z_{i}\)</span></li>
</ul>
<p>Stratification ensures equal representation of each stratum in the RV domain</p>
<ul>
<li>Always reduces variance, but could be marginal improvements.</li>
<li>It’s worth doing stratification when <strong>the target RV (payoff) changes over its domain.</strong> Like a payoff function that may be exponential.</li>
</ul>
<blockquote>
<p>Why don’t we always use it? It’s expensive, as you may need to calculate conditional distribution, and many details that require work to figure out. However, for the Normal, a conditional Normal is still Normal, which makes things easy in that particular case. Otherwise, it may require numerical computation and may not be worth it.</p>
</blockquote>
<p>Consider <span class="math inline">\(\# m\)</span> equi-probable Normal strata <span class="math inline">\(\left\{A_j\right\}\)</span>
<span class="math display">\[
P\left(Z \in A_j\right)=1 / m \text { for } Z \sim N(0,1), j=1, \ldots, m
\]</span>
Stratified estimator of <span class="math inline">\(Y=f(Z)\)</span> (payoff, but in general could be any function)
<span class="math display">\[
\begin{aligned}
&amp; \bar{Y}_{S t r}=\frac{1}{m} \sum_{j=1}^m \bar{Y}^{(j)}, \text { where } \bar{Y}^{(j)}=\frac{1}{n} \sum_{i=1}^n f\left(Z_i^{(j)}\right) \\
&amp; Z_i^{(j)} \sim^{\text {iid }} N\left(0,1 \mid Z_i^{(j)} \in A_j\right), j=1, \ldots, m
\end{aligned}
\]</span>
- <span class="math inline">\(\bar{Y}^{(j)}\)</span> is estimator within each stratum <span class="math inline">\(j\)</span></p>
<p>We can verify that <span class="math inline">\(\bar{Y}_{Str}\)</span> is an unbiased estimator of <span class="math inline">\(\mathbb{E}(f(Z))\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}(\bar{Y}_{Str}) &amp;= \mathbb{E}\left[ \frac{1}{m}\sum^{m}_{j=1}\bar{Y}^{(j)} \right] = \frac{1}{m}\sum^{m}_{j=1} \mathbb{E}[\bar{Y}^{j}]\\
&amp;= \frac{1}{m} \sum^{m}_{j=1} \mathbb{E} \left( \frac{1}{n}\sum^{n}_{i=1} Y_{j}^{(i)} \right)\\
&amp;= \frac{1}{m}\sum^{m}_{j=1} \frac{1}{n}\sum^{n}_{i=1}\underbrace{ \mathbb{E}\left[ Y_{i}^{(j)} \right]  }_{ \mathbb{E}[Y | Z \in A_{j}] = \mathbb{E}\left[ f(Z) | Z \in A_{j} \right]  }\\
&amp;= \frac{1}{m} \sum^{m}_{j=1} \frac{1}{n}n \mathbb{E}[f(Z)|Z \in A_{j}]\\
&amp;= \frac{1}{m} \sum^{m}_{j=1} \mathbb{E}(f(Z)|Z \in A_{j})\\
&amp;= \sum^{m}_{j=1}\mathbb{E}\left[ f(Z) | Z \in A_{j}\right] \cdot P(A \in A_{j})\\
\text{By Law of Tot. Prob }&amp;= \mathbb{E}(f(Z)) \cdot \mathbb{E}(Y)\\
\end{aligned}
\]</span></p>
<p>We want to show that stratified sampling cannot do worse (higher variance) than simple random sampling</p>
<p>ie <span class="math inline">\(\mathbb{V}(\bar{Y}_{Str}) \leq \mathbb{V}(\bar{Y})\)</span> where <span class="math inline">\(\bar{Y} = \frac{1}{nm} \sum^{nm}_{i=1}f(Z_{i})\)</span>, with <span class="math inline">\(n\)</span> numbers per <span class="math inline">\(m\)</span> strata</p>
<blockquote>
<p>Stratification can’t always be used because it’s computationally expensive</p>
</blockquote>
<p><span class="math display">\[
\begin{aligned}
\mathbb{V}(\bar{Y}) = \mathbb{V}\left( \frac{1}{nm} \sum^{nm}_{i=1} Y_{i} \right) &amp;= \frac{1}{nm} \mathbb{V}(Y_{i})\\
&amp;= \frac{1}{nm} \left( \mathbb{E}[Y_{i}^{2}] \cdot [\mathbb{E}(Y_{i})]^{2} \right) \\
&amp;= \frac{1}{nm} \left[ \mathbb{E}(f^{2}(z)) \right] - \mu^{2}\\
\end{aligned}
\]</span>
<span class="math display">\[
\begin{aligned}
\mathbb{V}(\bar{Y}_{Str}) &amp;= \mathbb{V}\left( \frac{1}{m} \sum^{m}_{j=1} \bar{Y}^{(j)} \right) \\
&amp;= \frac{1}{m^{2}} \sum^{m}_{j=1} \mathbb{V}(\bar{Y}^{(j)})\\
&amp;= \frac{1}{m^{2}} \sum^{m}_{j=1} \mathbb{V}\left[ \frac{1}{n} \sum^{n}_{i=1} \underbrace{ Y^{(j)} }_{ \text{iid in each sample} } \right] \\
&amp;= \frac{1}{m^{2}n^{2}} \sum^{m}_{j=1} \sum^{n}_{i=1} \mathbb{V}\left( Y_{i}^{(j)} \right) \\
&amp;= \frac{1}{m^{2}n^{2}} \sum^{m}_{j=1} n\mathbb{V}(Y^{(j)})\\
&amp;= \frac{1}{m^{2}n} \sum^{m}_{j=1} \mathbb{V}(\underbrace{ Y }_{ f(z) }|z\in A_{j})\\
&amp;= \frac{1}{m^{2}n} \sum^{m}_{j=1}\left[ \mathbb{E} \left( f^{2}(z)|z \in A_{j} \right) - \left( \mathbb{E}(f(z))|z \in A_{j} \right)^{2} \right] \\
&amp;= \frac{1}{mn} \left\{ \overbrace{ \sum^{m}_{j=1}\mathbb{E}\left[ f^{2}(z)|z \in A_{j} \right] \cdot \underbrace{ \frac{1}{m} }_{ P(z\in A_{j}) } }^{ \text{By LTP, } \mathbb{E}[f^{2}(z)] } - \frac{1}{m} \sum^{m}_{j=1} \underbrace{ \left( \mathbb{E}(f(z)|z \in A_{j})^{2} \right) }_{ \mu_{j} }  \right\}\\
&amp;= \frac{1}{mn} \left\{ \mathbb{E}\left[ f^{2}(z) - \frac{1}{m}\sum^{m}_{j=1}\mu_{j}^{2}  \right]  \right\} \\
&amp;\leq \mathbb{V}\left[ \bar{Y} \right] = \frac{1}{mn}\left\{ \mathbb{E}\left[ f^{2}(z)-\mu^{2} \right]  \right\} \\
&amp;\iff \frac{1}{m} \sum^{m}_{j=1} \mu_{j}^{2} \geq \mu^{2}
\end{aligned}
\]</span></p>
<p>Which is true by Jensens Inequality.</p>
<p>Note <span class="math inline">\(\mu = \frac{1}{m} \sum^{m}_{j=1}\mu_{j} = \sum^{m}_{j=1}\underbrace{ \mathbb{E}\left[ f(z)|z\in A_{j} \right] }_{ \mu_{j} }\underbrace{ P(A_{j}) }_{ 1/m }\)</span></p>
<p>For convex functions:
<span class="math display">\[
g(x) = x^{2}, \text{then } \mathbb{E}(g(X)) = \underbrace{ \mathbb{E}(X^{2}) }_{ \frac{1}{m}\sum^{m}_{j=1}\mu_{j}^{2} } \geq \underbrace{ \left( \mathbb{E}(X) \right)^{2} }_{ \left( \frac{1}{m}\sum^{m}_{j=1}\mu_{j} \right)^{2} = \mu^{2} }
\]</span></p>
<blockquote>
<p>Because we’re subtracting a larger value in the variance, then we get a smaller variance. If we have a payoff that has lots of jumps/large values, then this would give us lots of benefit.</p>
</blockquote>
<p><img src="Notes/Obsidian-Attachments/12-Simulation-Variance-Reduction-1.png" /></p>
<blockquote>
<p>The more strata used, the bigger the benefit. This may be known as quasi Monte Carlo, but in the multivariate case it becomes a large pain.</p>
</blockquote>
</div>
<div id="control-variates" class="section level3 hasAnchor" number="14.1.3">
<h3><span class="header-section-number">14.1.3</span> Control Variates<a href="variance-reduction.html#control-variates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Comes from regression</p>
</blockquote>
<p>To estimate <span class="math inline">\(\mathbb{E}(Y) = \mathbb{E}[f(z)]\)</span> using MC, we generate iid <span class="math inline">\(Z_{i}\)</span> and use</p>
<p><span class="math display">\[
\bar{Y} = \sum^{n}_{i=1} \frac{Y_{i}}{n} = \sum^{n}_{i=1} \left( \frac{f(Z_{i})}{n} \right)
\]</span></p>
<p>For our purposes, <span class="math inline">\(f(\cdot)\)</span> is the option’s discounted payoff</p>
<p>We assume there is another option with payoff <span class="math inline">\(g(\cdot)\)</span> whose price we already know
<span class="math inline">\(\mathbb{E}(X) = \mathbb{E}(g(Z))\)</span></p>
<p>Idea: Use MC with same variates to estimate both <span class="math inline">\(\mathbb{E}(Y)\)</span> and <span class="math inline">\(\mathbb{E}(X)\)</span>, but adjust estimate <span class="math inline">\(\bar{Y}\)</span> to take into account the error of estimate <span class="math inline">\(\bar{X}\)</span></p>
<ul>
<li>E.g., if <span class="math inline">\(\bar{X}\)</span> underestimates <span class="math inline">\(\mathbb{E}[X]\)</span> then we can adjust <span class="math inline">\(\bar{Y}\)</span> upward because it most likely also underestimates <span class="math inline">\(\mathbb{E}(Y)\)</span>.</li>
</ul>
<p>For our purposes, we’ll focus on linear adjustments.</p>
<div id="example-5" class="section level4 hasAnchor" number="14.1.3.1">
<h4><span class="header-section-number">14.1.3.1</span> Example<a href="variance-reduction.html#example-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Adjust <span class="math inline">\(\bar{Y}\)</span> for estimation error <span class="math inline">\(\bar{X}-\mathbb{E}(X)\)</span> linearly, as
<span class="math display">\[
\bar{Y}(b) = \bar{Y}-b(\bar{X}-\mathbb{E}(X))
\]</span></p>
<blockquote>
<p>No matter what value of <span class="math inline">\(b\)</span> we choose, the estimator will be unbiased (even though it may inefficient)</p>
</blockquote>
<p>We will show that this is an unbiased estimator.</p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}(\bar{Y}(b)) &amp;= \mathbb{E}[\bar{Y}-b(\bar{X}-\mathbb{E}(X))]\\
&amp;= \underbrace{ \mathbb{E}(\bar{Y}) }_{ \mathbb{E}(Y) } - b(\underbrace{ \mathbb{E}(\bar{X}) }_{ \mathbb{E}(X) }-\mathbb{E}(X))\\
&amp;= \mathbb{E}(Y) - b\cdot(\mathbb{E}(X)-\mathbb{E}(X))
\end{aligned}
\]</span></p>
<blockquote>
<p>On average the adjustment will always be 0, but for certain choices of <span class="math inline">\(b\)</span>, we can make the estimator much more efficient. We find <span class="math inline">\(b\)</span> using regression on the random variables of <span class="math inline">\(Y,X\)</span> that we’ve simulated.</p>
</blockquote>
<p>We can also find the variance of <span class="math inline">\(\bar{Y}(b)\)</span></p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{V}[\bar{Y}(b)] &amp;= \mathbb{V}[\bar{Y}-b(\bar{X}-\mathbb{E}(X))] = \mathbb{V}[\bar{Y}-b\bar{X}]\\
&amp;= \mathbb{V}(\bar{Y}) + b^{2}\mathbb{V}(\bar{X})-2bCov(\bar{Y},\bar{X})\\
&amp;= \frac{1}{n}\mathbb{V}(Y)+b^{2} \frac{1}{n}\mathbb{V}(X) - 2bCov\left( \frac{1}{n}\sum^{n}_{i=1}\underbrace{ f(z_{i}) }_{ Y_{i} },\ \ \frac{1}{n}\sum^{n}_{i=1}\underbrace{ g(z_{i}) }_{ X_{i} } \right)\\
&amp;= \frac{1}{n}\underbrace{ \mathbb{V}(Y) }_{ \sigma^{2}_{y} }+b^{2}\frac{1}{n}\underbrace{ \mathbb{V}(X) }_{ \sigma^{2}_{x} }-2b \frac{1}{n^{2}}nCov(f(Z)), g(Z))\\
&amp;= \frac{1}{n}\left[ \sigma^{2}_{y}+b^{2}\sigma^{2}_{x}-2b \sigma_{xy}\right]
\end{aligned}
\]</span></p>
<p>We can also show that the optimal value of <span class="math inline">\(b\)</span> is <span class="math inline">\(b^{\star}= \frac{Cov(X,Y)}{Var[X]}\)</span> which is the regression slope coefficient</p>
<p><span class="math display">\[
\begin{aligned}
\frac{ \partial  }{ \partial b } \mathbb{V}(\bar{Y}(b)) = 0 \implies&amp; \frac{ \partial  }{ \partial b } \left( \frac{1}{n} [\sigma^{2}_{y}+b^{2}\sigma^{2}_{x}-2b\sigma_{xy}] \right) = 0\\
b\sigma^{2}_{x}-\sigma_{xy}&amp;= 0\\
\implies&amp; b = \frac{\sigma_{xy}}{\sigma_{x}^{2}} = \frac{Cov(X,Y)}{Var(X)} = \left( \frac{\sigma_{xy}\sigma_{x}\sigma_{y}}{\sigma_{x}^{2}} = \sigma_{xy} \frac{\sigma_{y}}{\sigma_{x}} \right)
\end{aligned}
\]</span></p>
<p>We want the expected val of <span class="math inline">\(Y\)</span>, which we can calculate by finding the above.</p>
<p>In practice, don’t know <span class="math inline">\(\operatorname{Cov}[X, Y], \operatorname{Var}[X]\)</span> so estimate <span class="math inline">\(b^*\)</span> using MC sample</p>
<p><span class="math display">\[
\hat{b}=\frac{\sum_{i=1}^n\left(X_i-\bar{X}\right)\left(Y_i-\bar{Y}\right)}{\sum_{i=1}^n\left(X_i-\bar{X}\right)^2}
\]</span></p>
<p><img src="Notes/Obsidian-Attachments/12-Simulation-Variance-Reduction-2.png" /></p>
<blockquote>
<p>We want to find <span class="math inline">\(\mathbb{E}(Y)\)</span> with the knowledge of what <span class="math inline">\(\mathbb{E}(X)\)</span> is. We can then estimate the correlation/slope.</p>
</blockquote>
<p>Furthermore, we now show that the optimal variance is <span class="math inline">\(Var(\bar{Y}(b^{\star})=Var[\bar{Y}](1-\rho^{2}_{XY})\)</span></p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{V}[\bar{Y}(b^{\star})] &amp;= \frac{1}{n} (\sigma_{y}^{2}-b^{\star 2}\sigma_{x}^{2}-2b^{\star}\sigma_{XY})\\
&amp;= \frac{1}{n} \left( \sigma_{y}^{2}+\left( \rho_{XY} \frac{\sigma_{Y}}{\sigma_{X}} \right) \sigma_{x}\sigma_{Y}\rho_{XY} \right) \\
&amp;= \frac{1}{n} \left( \sigma_{Y}^{2}+\rho_{XY}^{2}\sigma_{y}^{2} - 2\rho^{2}_{XY}\sigma_{Y}^{2} \right) \\
&amp;= \frac{1}{n}\sigma_{Y}^{2}(1-\rho_{XY}^{2})\\
&amp;= \mathbb{V}(\bar{Y})\cdot(1-\rho^{2}_{XY})
\end{aligned}
\]</span>
- In practice, use sample estimates of <span class="math inline">\(\operatorname{Var}[\bar{Y}], \rho_{X Y}\)</span>
Good control variates have high absolute correlation with option payoff (high <span class="math inline">\(\left.\rho_{X Y}\right)\)</span> !</p>
<p>We can apply this to price a European option</p>
</div>
<div id="example-6" class="section level4 hasAnchor" number="14.1.3.2">
<h4><span class="header-section-number">14.1.3.2</span> Example<a href="variance-reduction.html#example-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Price a European option using final asset price (<span class="math inline">\(S_{T}\)</span>) as control assuming GBM w/ <span class="math inline">\(r,\sigma\)</span>.
We know:</p>
<ul>
<li><span class="math inline">\(X=S_{T}=g(Z)=S_{0}\exp \left\{ \left( r-\frac{\sigma^{2}}{2} \right)T+\sigma \sqrt{ T }\cdot Z \right\}\)</span></li>
<li><span class="math inline">\(\mathbb{E}(X) = \mathbb{E}(S_{T}) = S_{0}e^{rT}\)</span></li>
</ul>
<p>We guess the correlation of control with the following:</p>
<ul>
<li>(Deep) In-the-money call (most likely to be exercised): <span class="math inline">\(\rho_{XY} \approx 1\)</span>
<ul>
<li><span class="math inline">\(Cov((S_{T}-K)_{+}, S_{T})\)</span> which is most likely positively correlated</li>
</ul></li>
<li>Out-of-the-money call: <span class="math inline">\(\rho_{XY}\approx 0\)</span>
<ul>
<li><span class="math inline">\(Cov(0, S_{T}) \approx 0\)</span></li>
</ul></li>
<li>In the money put: <span class="math inline">\(\rho_{XY} \approx -1\)</span></li>
<li>Out of the money put: <span class="math inline">\(\rho_{XY} \approx 0\)</span></li>
</ul>
<p><img src="Notes/Obsidian-Attachments/12-Simulation-Variance-Reduction-3.png" /></p>
<blockquote>
<p>This produced a closer estimate than simple MC, but it is much more complex to calculate (almost double the computation, as it uses twice as many samples).
If we doubled the samples for simple MC, then the SE would drop by a factor of <span class="math inline">\(\frac{1}{\sqrt{ n }}\)</span></p>
</blockquote>
</div>
</div>
<div id="importance-sampling" class="section level3 hasAnchor" number="14.1.4">
<h3><span class="header-section-number">14.1.4</span> Importance Sampling<a href="variance-reduction.html#importance-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Idea: Attempt to reduce variance by <strong>changing the distribution</strong> (probability measure) from which paths (random variates) are generated.</p>
<ul>
<li>Change measure to give more weight to important outcomes, thereby increasing sample efficiency</li>
<li>E.g. for European call, put more weight to paths with positive payoff i.e., for which we exercise)</li>
</ul>
<p>Performance of importance sampling relies <strong>heavily</strong> on equivalent measure being used.</p>
<p>We want to estimate <span class="math inline">\(a=\mathbb{E}_{\phi}[f(Z)]=\int _{z} f(z)\phi(z) \, dz\)</span> where <span class="math inline">\(\phi(z)\)</span> is the pdf of <span class="math inline">\(Z\)</span> (Normal in this case)</p>
<ul>
<li>In the Simple MC: Generate sample <span class="math inline">\(Z_{i} \sim^{iid} \phi, \quad i=1,\dots,n\)</span> and use <span class="math inline">\(\hat{\alpha}=\frac{\sum^{n}_{i=1}f(Z_{i})}{n}\)</span> which by CLT and LLN it will converge to <span class="math inline">\(\mathbb{E}_{\phi}(f(Z))\)</span></li>
</ul>
<p>Assuming you ahve a same <span class="math inline">\(Z&#39;_{i} \sim^{iid} \psi, \quad i = 1,\dots,n\)</span> from a new pdf <span class="math inline">\(\psi\)</span>, you can still estimate <span class="math inline">\(\alpha\)</span> as follows:</p>
<p><span class="math display">\[
\begin{gathered}
\alpha = \int _{z} f(z) \phi(z) \, dz = \int _{z} f(z) \frac{\phi(z)}{\psi(z)} \psi(z) \, dz = \mathbb{E}_{z}\left[ f(Z&#39;) \frac{\phi(Z&#39;)}{\psi(Z&#39;)} \right]\\
\implies\hat{\alpha} = \frac{1}{n} \sum^{n}_{i=1} f(Z&#39;_{i}) \frac{\phi(Z&#39;)}{\psi(Z&#39;)}
\end{gathered}
\]</span></p>
<blockquote>
<p>Also used in some cases where you can’t simulate efficiently from <span class="math inline">\(\phi(Z)\)</span>, but you have a way to calculate this density. You can simulate from a distribution that has a cdf <span class="math inline">\(\psi(Z)\)</span> instead, and has a method of simulating variates from.</p>
</blockquote>
<blockquote>
<p>There is a way to simulate from a Normal distribution (which doesn’t have a CDF) other than this, he did not mention exactly what, nor should it be that important.</p>
</blockquote>
<div id="importance-sampling-is-unbiased" class="section level4 hasAnchor" number="14.1.4.1">
<h4><span class="header-section-number">14.1.4.1</span> Importance Sampling is unbiased<a href="variance-reduction.html#importance-sampling-is-unbiased" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Proof that <span class="math inline">\(\hat{\alpha&#39;}\)</span> is unbiased provided the simple MC estimate <span class="math inline">\(\hat{\alpha}\)</span> is unbiased.</p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}_{\psi}[\hat{\alpha&#39;}] &amp;= \mathbb{E}_{\psi} \left[ \frac{1}{n} \sum f(Z_{i}&#39;) \frac{\phi(Z&#39;_{i})}{\psi(Z&#39;_{i})} \right]\\
&amp;= \frac{1}{n} \sum_{i=1}^{n} \mathbb{E}_{\psi} \left[ f(Z&#39;_{i}) \frac{\phi(Z&#39;_{i})}{\psi(Z&#39;_{i})} \right]\\
&amp;= \int _{-\infty}^{\infty} \underbrace{ f(z&#39;) \frac{\phi(z&#39;)}{\psi(z&#39;)} }_{ value } \underbrace{ \psi(z&#39;) }_{ prob } \, dz&#39;\\
&amp;= \int ^{\infty}_{-\infty} f(z&#39;) \phi(z&#39;) \, dz&#39;\\
&amp;= \mathbb{E}_{\phi} \left[ f(z) \right] \\
&amp;= \alpha
\end{aligned}
\]</span></p>
<p>But when is this efficient (better than simple MC)?</p>
<blockquote>
<p>When the variance of <span class="math inline">\(\hat{\alpha}&#39;\)</span> is lower</p>
</blockquote>
<p><span class="math display">\[
\begin{aligned}
\mathbb{V}_{\psi}(\hat{\alpha}&#39;) &amp;= \mathbb{V}_{\psi} \left[ \frac{1}{n} \sum^{n}_{i=1}  f(z&#39;) \frac{\phi(z&#39;)}{\psi(z&#39;)} \right] \\
&amp;= \frac{1}{n} \mathbb{V} \left[ f(z&#39;_{i}) \frac{\phi(z&#39;_{i})}{\psi(z&#39;_{i})} \right] \\
&amp;= \frac{1}{n} \left\{ \mathbb{E}_{\psi} \left[ \left( f(z&#39;) \frac{\phi(z&#39;)}{\psi(z&#39;)} \right)^{2} \right] - \left( \mathbb{E}_{\psi} \left[ f(z&#39;) \frac{\phi(z&#39;)}{\psi(z&#39;)} \right]  \right)^{2} \right\}
\end{aligned}
\]</span></p>
<p>Now we show that this variance is lower than <span class="math inline">\(\mathbb{V}_{\phi}(\hat{\alpha})\)</span> iff <span class="math inline">\(\mathbb{E}_{\phi} \left[ f^{2}(Z) \frac{\phi(Z)}{\psi(Z)} \right] \leq \mathbb{E}_{\phi}\left[ f^{2}(Z) \right]\)</span></p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{V}_{\psi}\left[ \hat{\alpha}&#39; \right] \leq \mathbb{V}_{\phi}[\hat{\alpha}] &amp;\iff \frac{1}{n} \left\{ \mathbb{E}_{\psi}\left[ \left( f(z&#39;) \frac{\phi(z&#39;)}{\psi(z&#39;)} \right)^{2} \right] - \alpha^{2} \right\} \leq \frac{1}{n} \left\{ \mathbb{E}_{\phi} \left[ f^{2}(z) \right] -\alpha^{2} \right\} \\
&amp;\iff \mathbb{E}_{\psi}\left[ f^{2}(z&#39;) \frac{\phi^{2}(z&#39;)}{\psi^{2}(z&#39;)} \right] \leq \mathbb{E}_{\phi} \left[ f^{2}(z) \right]\\
&amp;\iff \int  f^{2}(z&#39;) \frac{\phi^{2}(z&#39;)}{\psi^{2}(z&#39;)} \psi(z&#39;) \, dz&#39; = \int f^{2}(z&#39;) \frac{\phi(z&#39;)}{\psi(z&#39;)} \phi(z&#39;) \, dz&#39;\\
&amp;\quad \quad \quad = \mathbb{E}_{\phi}\left[ f^{2}(z) \frac{\phi(z)}{\psi(z)} \right]
\end{aligned}
\]</span></p>
<p>We can even show that <span class="math inline">\(\mathbb{V}_{\psi}[\hat{\alpha}] = 0\)</span> iff <span class="math inline">\(\psi(z) \propto f(z)\psi(z)\)</span> for positive <span class="math inline">\(f\)</span>.</p>
<blockquote>
<p>Then <span class="math inline">\(\psi(z) = \frac{1}{c} f(z)\phi(z) \implies \int \psi(z) \, dz = 1\)</span>
<span class="math inline">\(\implies \int \frac{1}{c} f(z)\phi(z) \, dz = 1 \implies \int f(z)\phi(z) \, dz = \mathbb{E}_{\phi}[f(Z)]\)</span></p>
</blockquote>
<blockquote>
<p>We need the price of the option to be finite, or the integral will not be finite. If the <span class="math inline">\(\phi\)</span> idstirbution is completely proportional to the functions, then the normalizing value is exactly what we’re looking for. This is an extreme case, although the overall idea is that we want <span class="math inline">\(\psi\)</span> to be as similar as possible</p>
</blockquote>
<p><span class="math display">\[
\begin{aligned}
\mathbb{V}_{\psi} [\hat{\alpha}&#39;] &amp;= \frac{1}{n} \left\{ \mathbb{E}_{\psi} \left[ \left( f(z&#39;) \frac{\phi(z&#39;)}{\psi(z&#39;)} \right)^{2}  \right]  -\alpha^{2} \right\} \\
&amp;= \frac{1}{n} \left\{ \mathbb{E}_{\psi} \left[ \left( \frac{f(z&#39;)\phi(z&#39;)}{\frac{1}{c} f(z&#39;)\phi(z&#39;)} \right)^{2}  \right] -\alpha^{2} \right\}\\
&amp;= \frac{1}{n} \left\{ \underbrace{ \mathbb{E}_{\psi} \left[ c^{2}\right] }_{ \alpha^{2} } -\alpha^{2} \right\}\\
&amp;= \frac{1}{n} \left( \alpha^{2} -\alpha^{2}\right) =0\\
\end{aligned}
\]</span></p>
<blockquote>
<p>Importance sampling works best when new pdf <span class="math inline">\(\psi\)</span> “resembles” payoff <span class="math inline">\(\times\)</span> (original pdf) <span class="math inline">\(f \times \varphi\)</span></p>
</blockquote>
</div>
<div id="extending-to-paths" class="section level4 hasAnchor" number="14.1.4.2">
<h4><span class="header-section-number">14.1.4.2</span> Extending to paths<a href="variance-reduction.html#extending-to-paths" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Importance sampling can be extended to multiple random variates per path
- E.g. path-dependent option, with payoff <span class="math inline">\(f\left(Z_1, \ldots, Z_m\right)\)</span> a function of <span class="math inline">\(\# m\)</span> variates forming discretized path
<span class="math display">\[
E_{\varphi}\left[f\left(Z_1, \ldots, Z_m\right)\right]=E_\psi\left[f\left(Z_1^{\prime}, \ldots, Z_m^{\prime}\right) \frac{\varphi\left(Z_1^{\prime}, \ldots, Z_m^{\prime}\right)}{\psi\left(Z_1^{\prime}, \ldots, Z_m^{\prime}\right)}\right]
\]</span>
- If in addition, <span class="math inline">\(Z_j \sim^{i i d} \varphi_j \&amp; Z_j^{\prime} \sim^{i i d} \psi_j\)</span>, then
<span class="math display">\[
E_{\varphi}\left[f\left(Z_1, \ldots, Z_m\right)\right]=E_\psi\left[f\left(Z_1^{\prime}, \ldots, Z_m^{\prime}\right) \prod_{j=1}^m \frac{\varphi_j\left(Z_j^{\prime}\right)}{\psi_j\left(Z_j^{\prime}\right)}\right]
\]</span></p>
</div>
</div>
<div id="ex.-deep-ootm-european-call" class="section level3 hasAnchor" number="14.1.5">
<h3><span class="header-section-number">14.1.5</span> Ex. Deep OOTM European Call<a href="variance-reduction.html#ex.-deep-ootm-european-call" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(S_{0} = 50, K = 65\)</span>
Find the price of the option using simple MC</p>
<blockquote>
<p>Generate final prices from the log Normal distribution</p>
</blockquote>
<ul>
<li>With simple MC, generate final prices as
<span class="math display">\[
S_T=S_0 e^Z, \text { where } Z \sim \varphi=N\left(\left(r-\frac{\sigma^2}{2}\right) T, \sigma^2 T\right)
\]</span>
What would be a good candidate for <span class="math inline">\(\psi\)</span> ?
<span class="math display">\[
Z^{\prime} \sim \psi=N\left(\log \left(\frac{90}{50}\right)-\frac{\sigma^2}{2} T, \sigma^2 T\right) \text { or } N\left(\log \left(\frac{30}{50}\right)-\frac{\sigma^2}{2} T, \sigma^2 T\right)
\]</span></li>
</ul>
<blockquote>
<p>Only diff is the mean, but the first distrbution has a higher mean, which is what we want to simluate from as we want the final price to be closer to higher values (65)</p>
</blockquote>
<p><img src="Notes/Obsidian-Attachments/12-Simulation-Variance-Reduction-4.png" /></p>
<p><img src="Notes/Obsidian-Attachments/12-Simulation-Variance-Reduction-5.png" /></p>
<blockquote>
<p>Most of the values simulated in the black distribution (RN measure) you would get 0 payoff, except in the tail. We want to shift the distribution so most of the simulations give us a positive pay off, such as in the green distribution. This will do much better in simulation.
The blue distribution is the payoff x RN measure that we ideally want to simulate (but we can’t actually get since <span class="math inline">\(\phi\)</span> is hard to get?)</p>
</blockquote>
<p><img src="Notes/Obsidian-Attachments/12-Simulation-Variance-Reduction-6.png" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pricing-derivatives.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="optimization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/Notes/12-Simulation-Variance-Reduction.md",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
