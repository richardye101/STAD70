<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Q2.1 | STAD70 Course Work</title>
  <meta name="description" content="A collection of homework and assignments from the STAD70 course at UTSC" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Q2.1 | STAD70 Course Work" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A collection of homework and assignments from the STAD70 course at UTSC" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Q2.1 | STAD70 Course Work" />
  
  <meta name="twitter:description" content="A collection of homework and assignments from the STAD70 course at UTSC" />
  

<meta name="author" content="Richard Ye" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="problem-set-4.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.0/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAD70 Work</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html"><i class="fa fa-check"></i><b>2</b> Financial Data and Returns</a>
<ul>
<li class="chapter" data-level="2.1" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#trading"><i class="fa fa-check"></i><b>2.1</b> Trading</a></li>
<li class="chapter" data-level="2.2" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#order-types"><i class="fa fa-check"></i><b>2.2</b> Order Types</a></li>
<li class="chapter" data-level="2.3" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#returns"><i class="fa fa-check"></i><b>2.3</b> Returns</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#net-returns"><i class="fa fa-check"></i><b>2.3.1</b> Net Returns</a></li>
<li class="chapter" data-level="2.3.2" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#log-returns"><i class="fa fa-check"></i><b>2.3.2</b> Log Returns</a></li>
<li class="chapter" data-level="2.3.3" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#returns-accounting-for-dividends"><i class="fa fa-check"></i><b>2.3.3</b> Returns accounting for dividends</a></li>
<li class="chapter" data-level="2.3.4" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#returns-accounting-for-splits"><i class="fa fa-check"></i><b>2.3.4</b> Returns accounting for splits</a></li>
<li class="chapter" data-level="2.3.5" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#adjusted-returns"><i class="fa fa-check"></i><b>2.3.5</b> Adjusted returns</a></li>
<li class="chapter" data-level="2.3.6" data-path="financial-data-and-returns.html"><a href="financial-data-and-returns.html#random-walk-model"><i class="fa fa-check"></i><b>2.3.6</b> Random Walk Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="return-distributions.html"><a href="return-distributions.html"><i class="fa fa-check"></i><b>3</b> Return Distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="return-distributions.html"><a href="return-distributions.html#skewness"><i class="fa fa-check"></i><b>3.1</b> Skewness</a></li>
<li class="chapter" data-level="3.2" data-path="return-distributions.html"><a href="return-distributions.html#kurtosis"><i class="fa fa-check"></i><b>3.2</b> Kurtosis</a></li>
<li class="chapter" data-level="3.3" data-path="return-distributions.html"><a href="return-distributions.html#qq-plot"><i class="fa fa-check"></i><b>3.3</b> QQ Plot</a></li>
<li class="chapter" data-level="3.4" data-path="return-distributions.html"><a href="return-distributions.html#heavy-tail-distributions"><i class="fa fa-check"></i><b>3.4</b> Heavy Tail Distributions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="return-distributions.html"><a href="return-distributions.html#common-heavy-tail-distributions"><i class="fa fa-check"></i><b>3.4.1</b> Common Heavy Tail Distributions</a>
<ul>
<li class="chapter" data-level="3.4.1.1" data-path="return-distributions.html"><a href="return-distributions.html#pareto"><i class="fa fa-check"></i><b>3.4.1.1</b> Pareto</a></li>
<li class="chapter" data-level="3.4.1.2" data-path="return-distributions.html"><a href="return-distributions.html#cauchy"><i class="fa fa-check"></i><b>3.4.1.2</b> Cauchy</a></li>
<li class="chapter" data-level="3.4.1.3" data-path="return-distributions.html"><a href="return-distributions.html#students-t"><i class="fa fa-check"></i><b>3.4.1.3</b> Students t</a></li>
</ul></li>
<li class="chapter" data-level="3.4.2" data-path="return-distributions.html"><a href="return-distributions.html#stable-distributions"><i class="fa fa-check"></i><b>3.4.2</b> Stable Distributions</a>
<ul>
<li class="chapter" data-level="3.4.2.1" data-path="return-distributions.html"><a href="return-distributions.html#generalized-central-limit-theorem"><i class="fa fa-check"></i><b>3.4.2.1</b> Generalized Central Limit Theorem</a></li>
<li class="chapter" data-level="3.4.2.2" data-path="return-distributions.html"><a href="return-distributions.html#measuring-tail-behaviour"><i class="fa fa-check"></i><b>3.4.2.2</b> Measuring tail behaviour</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="return-distributions.html"><a href="return-distributions.html#mixture-distributions"><i class="fa fa-check"></i><b>3.5</b> Mixture Distributions</a>
<ul>
<li class="chapter" data-level="3.5.0.1" data-path="return-distributions.html"><a href="return-distributions.html#normal-scale-mixture"><i class="fa fa-check"></i><b>3.5.0.1</b> Normal scale mixture</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html"><i class="fa fa-check"></i><b>4</b> Modelling Extreme Events</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#stylized-facts"><i class="fa fa-check"></i><b>4.1</b> Stylized Facts</a></li>
<li class="chapter" data-level="4.2" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#extreme-value-theory"><i class="fa fa-check"></i><b>4.2</b> Extreme Value Theory</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#two-main-results"><i class="fa fa-check"></i><b>4.2.1</b> Two main results</a></li>
<li class="chapter" data-level="4.2.2" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#st-theorem-fisher-tippet-gnedenko"><i class="fa fa-check"></i><b>4.2.2</b> 1st Theorem: Fisher-Tippet-Gnedenko</a></li>
<li class="chapter" data-level="4.2.3" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#generalized-extreme-value-gev-distribution"><i class="fa fa-check"></i><b>4.2.3</b> Generalized Extreme Value (GEV) Distribution</a></li>
<li class="chapter" data-level="4.2.4" data-path="modelling-extreme-events.html"><a href="modelling-extreme-events.html#nd-theorem-pickands-balkema-de-haan"><i class="fa fa-check"></i><b>4.2.4</b> 2nd Theorem: Pickands-Balkema-De Haan</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-return-modelling.html"><a href="multivariate-return-modelling.html"><i class="fa fa-check"></i><b>5</b> Multivariate Return Modelling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multivariate-return-modelling.html"><a href="multivariate-return-modelling.html#covariance-correlation-matrix"><i class="fa fa-check"></i><b>5.1</b> Covariance &amp; Correlation Matrix</a></li>
<li class="chapter" data-level="5.2" data-path="multivariate-return-modelling.html"><a href="multivariate-return-modelling.html#multivariate-students-t-distribution"><i class="fa fa-check"></i><b>5.2</b> Multivariate Student’s t Distribution</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="copulas.html"><a href="copulas.html"><i class="fa fa-check"></i><b>6</b> Copulas</a>
<ul>
<li class="chapter" data-level="6.1" data-path="copulas.html"><a href="copulas.html#the-independence-copula"><i class="fa fa-check"></i><b>6.1</b> The independence copula</a></li>
<li class="chapter" data-level="6.2" data-path="copulas.html"><a href="copulas.html#sklars-theorem"><i class="fa fa-check"></i><b>6.2</b> Sklar’s Theorem</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="copulas.html"><a href="copulas.html#example"><i class="fa fa-check"></i><b>6.2.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="copulas.html"><a href="copulas.html#gaussian-copula"><i class="fa fa-check"></i><b>6.3</b> Gaussian Copula</a></li>
<li class="chapter" data-level="6.4" data-path="copulas.html"><a href="copulas.html#creating-copulas-from-multivariate-distributions"><i class="fa fa-check"></i><b>6.4</b> Creating Copula’s from Multivariate Distributions</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="copulas.html"><a href="copulas.html#copula-example-plots"><i class="fa fa-check"></i><b>6.4.1</b> Copula example plots</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="copulas.html"><a href="copulas.html#elliptical-copulas"><i class="fa fa-check"></i><b>6.5</b> Elliptical Copulas</a></li>
<li class="chapter" data-level="6.6" data-path="copulas.html"><a href="copulas.html#archimedean-copulas"><i class="fa fa-check"></i><b>6.6</b> Archimedean Copulas</a></li>
<li class="chapter" data-level="6.7" data-path="copulas.html"><a href="copulas.html#fitting-copulas"><i class="fa fa-check"></i><b>6.7</b> Fitting Copula’s</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="portfolio-theory.html"><a href="portfolio-theory.html"><i class="fa fa-check"></i><b>7</b> Portfolio Theory</a>
<ul>
<li class="chapter" data-level="7.1" data-path="portfolio-theory.html"><a href="portfolio-theory.html#assumptions"><i class="fa fa-check"></i><b>7.1</b> Assumptions</a></li>
<li class="chapter" data-level="7.2" data-path="portfolio-theory.html"><a href="portfolio-theory.html#dealing-with-two-assets"><i class="fa fa-check"></i><b>7.2</b> Dealing with Two Assets</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="portfolio-theory.html"><a href="portfolio-theory.html#portfolio-return"><i class="fa fa-check"></i><b>7.2.1</b> Portfolio Return</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="portfolio-theory.html"><a href="portfolio-theory.html#efficiency-frontier"><i class="fa fa-check"></i><b>7.3</b> Efficiency frontier</a></li>
<li class="chapter" data-level="7.4" data-path="portfolio-theory.html"><a href="portfolio-theory.html#multiple-asset-portfolio"><i class="fa fa-check"></i><b>7.4</b> Multiple asset portfolio</a></li>
<li class="chapter" data-level="7.5" data-path="portfolio-theory.html"><a href="portfolio-theory.html#capm---capital-asset-pricing-model"><i class="fa fa-check"></i><b>7.5</b> CAPM - Capital Asset Pricing Model</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="portfolio-theory.html"><a href="portfolio-theory.html#market-portfolio"><i class="fa fa-check"></i><b>7.5.1</b> Market Portfolio</a></li>
<li class="chapter" data-level="7.5.2" data-path="portfolio-theory.html"><a href="portfolio-theory.html#capital-market-line"><i class="fa fa-check"></i><b>7.5.2</b> Capital Market Line</a></li>
<li class="chapter" data-level="7.5.3" data-path="portfolio-theory.html"><a href="portfolio-theory.html#security-market-line"><i class="fa fa-check"></i><b>7.5.3</b> Security Market Line</a>
<ul>
<li class="chapter" data-level="7.5.3.1" data-path="portfolio-theory.html"><a href="portfolio-theory.html#ex-find-market-portfolio-weights-and-sml-with-n-i.i.d-assets"><i class="fa fa-check"></i><b>7.5.3.1</b> Ex: Find market portfolio weights and SML with <span class="math inline">\(N\)</span> i.i.d assets</a></li>
</ul></li>
<li class="chapter" data-level="7.5.4" data-path="portfolio-theory.html"><a href="portfolio-theory.html#security-characteristic-line"><i class="fa fa-check"></i><b>7.5.4</b> Security Characteristic Line</a>
<ul>
<li class="chapter" data-level="7.5.4.1" data-path="portfolio-theory.html"><a href="portfolio-theory.html#alpha-beta"><i class="fa fa-check"></i><b>7.5.4.1</b> Alpha &amp; Beta</a></li>
</ul></li>
<li class="chapter" data-level="7.5.5" data-path="portfolio-theory.html"><a href="portfolio-theory.html#legacy-of-capm"><i class="fa fa-check"></i><b>7.5.5</b> Legacy of CAPM</a></li>
<li class="chapter" data-level="7.5.6" data-path="portfolio-theory.html"><a href="portfolio-theory.html#performance-evaluation"><i class="fa fa-check"></i><b>7.5.6</b> Performance Evaluation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="factor-models.html"><a href="factor-models.html"><i class="fa fa-check"></i><b>8</b> Factor Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="factor-models.html"><a href="factor-models.html#three-factor-models"><i class="fa fa-check"></i><b>8.1</b> Three Factor models</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="factor-models.html"><a href="factor-models.html#time-series-regression-models"><i class="fa fa-check"></i><b>8.1.1</b> Time Series Regression Models</a>
<ul>
<li class="chapter" data-level="8.1.1.1" data-path="factor-models.html"><a href="factor-models.html#fama-french-3-factor-model"><i class="fa fa-check"></i><b>8.1.1.1</b> Fama-French 3 Factor Model</a></li>
</ul></li>
<li class="chapter" data-level="8.1.2" data-path="factor-models.html"><a href="factor-models.html#statistical-factor-models"><i class="fa fa-check"></i><b>8.1.2</b> Statistical Factor Models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="factor-models.html"><a href="factor-models.html#principle-component-analysis-pca"><i class="fa fa-check"></i><b>8.2</b> Principle Component Analysis (PCA)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="factor-models.html"><a href="factor-models.html#selecting-components"><i class="fa fa-check"></i><b>8.2.1</b> Selecting Components</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="factor-models.html"><a href="factor-models.html#factor-analysis"><i class="fa fa-check"></i><b>8.3</b> Factor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="risk-measures.html"><a href="risk-measures.html"><i class="fa fa-check"></i><b>9</b> Risk Measures</a>
<ul>
<li class="chapter" data-level="9.1" data-path="risk-measures.html"><a href="risk-measures.html#value-at-risk-var"><i class="fa fa-check"></i><b>9.1</b> Value At Risk (VAR)</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="risk-measures.html"><a href="risk-measures.html#example-1"><i class="fa fa-check"></i><b>9.1.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="risk-measures.html"><a href="risk-measures.html#var-hides-tail-risk"><i class="fa fa-check"></i><b>9.2</b> VaR hides tail risk</a>
<ul>
<li class="chapter" data-level="9.2.0.1" data-path="risk-measures.html"><a href="risk-measures.html#mitigation-cond-var-or-expected-shortfall"><i class="fa fa-check"></i><b>9.2.0.1</b> Mitigation: Cond VaR or Expected Shortfall</a></li>
<li class="chapter" data-level="9.2.0.2" data-path="risk-measures.html"><a href="risk-measures.html#example-2"><i class="fa fa-check"></i><b>9.2.0.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="risk-measures.html"><a href="risk-measures.html#risk-measure-properties"><i class="fa fa-check"></i><b>9.3</b> Risk Measure Properties</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="risk-measures.html"><a href="risk-measures.html#example-that-var-and-cvar-satisfy-prop-2-3"><i class="fa fa-check"></i><b>9.3.1</b> Example that VAR and CVar satisfy prop 2 &amp; 3</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="risk-measures.html"><a href="risk-measures.html#entropic-var"><i class="fa fa-check"></i><b>9.4</b> Entropic VaR</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="risk-measures.html"><a href="risk-measures.html#evar-for-a-normal-distribution"><i class="fa fa-check"></i><b>9.4.1</b> EVaR for a Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="risk-measures.html"><a href="risk-measures.html#calculating-risk-measures"><i class="fa fa-check"></i><b>9.5</b> Calculating Risk Measures</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="betting-strategies.html"><a href="betting-strategies.html"><i class="fa fa-check"></i><b>10</b> Betting Strategies</a>
<ul>
<li class="chapter" data-level="10.1" data-path="betting-strategies.html"><a href="betting-strategies.html#problem-setup"><i class="fa fa-check"></i><b>10.1</b> Problem Setup</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="betting-strategies.html"><a href="betting-strategies.html#scenario-1-bet-fixed-amount"><i class="fa fa-check"></i><b>10.1.1</b> Scenario 1: Bet fixed amount</a>
<ul>
<li class="chapter" data-level="10.1.1.1" data-path="betting-strategies.html"><a href="betting-strategies.html#hidden-probability-of-ruin"><i class="fa fa-check"></i><b>10.1.1.1</b> Hidden probability of ruin</a></li>
</ul></li>
<li class="chapter" data-level="10.1.2" data-path="betting-strategies.html"><a href="betting-strategies.html#scenario-2-bet-entire-wealth"><i class="fa fa-check"></i><b>10.1.2</b> Scenario 2: Bet entire wealth</a></li>
<li class="chapter" data-level="10.1.3" data-path="betting-strategies.html"><a href="betting-strategies.html#scenario-3-exp-growth-wo-ruin"><i class="fa fa-check"></i><b>10.1.3</b> Scenario 3: Exp growth w/o ruin</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="betting-strategies.html"><a href="betting-strategies.html#kelly-criterion"><i class="fa fa-check"></i><b>10.2</b> Kelly Criterion</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="betting-strategies.html"><a href="betting-strategies.html#finding-the-optimal-value"><i class="fa fa-check"></i><b>10.2.1</b> Finding the Optimal Value</a></li>
<li class="chapter" data-level="10.2.2" data-path="betting-strategies.html"><a href="betting-strategies.html#geometric-average"><i class="fa fa-check"></i><b>10.2.2</b> Geometric average</a></li>
<li class="chapter" data-level="10.2.3" data-path="betting-strategies.html"><a href="betting-strategies.html#simple-example"><i class="fa fa-check"></i><b>10.2.3</b> Simple example</a></li>
<li class="chapter" data-level="10.2.4" data-path="betting-strategies.html"><a href="betting-strategies.html#kelly-criterion-in-investing"><i class="fa fa-check"></i><b>10.2.4</b> Kelly Criterion in Investing</a>
<ul>
<li class="chapter" data-level="10.2.4.1" data-path="betting-strategies.html"><a href="betting-strategies.html#example-in-investing"><i class="fa fa-check"></i><b>10.2.4.1</b> Example in investing</a></li>
</ul></li>
<li class="chapter" data-level="10.2.5" data-path="betting-strategies.html"><a href="betting-strategies.html#theoretical-properties"><i class="fa fa-check"></i><b>10.2.5</b> Theoretical properties</a></li>
<li class="chapter" data-level="10.2.6" data-path="betting-strategies.html"><a href="betting-strategies.html#criticisms"><i class="fa fa-check"></i><b>10.2.6</b> Criticisms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="problem-set-1.html"><a href="problem-set-1.html"><i class="fa fa-check"></i><b>11</b> Problem Set 1</a>
<ul>
<li class="chapter" data-level="11.1" data-path="problem-set-1.html"><a href="problem-set-1.html#q1"><i class="fa fa-check"></i><b>11.1</b> Q1</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="problem-set-1.html"><a href="problem-set-1.html#data-prep"><i class="fa fa-check"></i><b>11.1.1</b> Data Prep</a></li>
<li class="chapter" data-level="11.1.2" data-path="problem-set-1.html"><a href="problem-set-1.html#plot"><i class="fa fa-check"></i><b>11.1.2</b> Plot</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="problem-set-1.html"><a href="problem-set-1.html#q2"><i class="fa fa-check"></i><b>11.2</b> Q2</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="problem-set-1.html"><a href="problem-set-1.html#a"><i class="fa fa-check"></i><b>11.2.1</b> 2.a</a></li>
<li class="chapter" data-level="11.2.2" data-path="problem-set-1.html"><a href="problem-set-1.html#b"><i class="fa fa-check"></i><b>11.2.2</b> 2.b</a></li>
<li class="chapter" data-level="11.2.3" data-path="problem-set-1.html"><a href="problem-set-1.html#c"><i class="fa fa-check"></i><b>11.2.3</b> 2.c</a></li>
<li class="chapter" data-level="11.2.4" data-path="problem-set-1.html"><a href="problem-set-1.html#d"><i class="fa fa-check"></i><b>11.2.4</b> 2.d</a></li>
<li class="chapter" data-level="11.2.5" data-path="problem-set-1.html"><a href="problem-set-1.html#e"><i class="fa fa-check"></i><b>11.2.5</b> 2.e</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="problem-set-1.html"><a href="problem-set-1.html#q3"><i class="fa fa-check"></i><b>11.3</b> Q3</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="problem-set-1.html"><a href="problem-set-1.html#mean-of-daily-log-return"><i class="fa fa-check"></i><b>11.3.1</b> Mean of daily log-return</a></li>
<li class="chapter" data-level="11.3.2" data-path="problem-set-1.html"><a href="problem-set-1.html#volatility-of-daily-log-return"><i class="fa fa-check"></i><b>11.3.2</b> Volatility of daily log-return</a></li>
<li class="chapter" data-level="11.3.3" data-path="problem-set-1.html"><a href="problem-set-1.html#plot-1"><i class="fa fa-check"></i><b>11.3.3</b> Plot</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="problem-set-1.html"><a href="problem-set-1.html#q4"><i class="fa fa-check"></i><b>11.4</b> Q4</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="problem-set-1.html"><a href="problem-set-1.html#a-1"><i class="fa fa-check"></i><b>11.4.1</b> 4.a</a></li>
<li class="chapter" data-level="11.4.2" data-path="problem-set-1.html"><a href="problem-set-1.html#b-1"><i class="fa fa-check"></i><b>11.4.2</b> 4.b</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="problem-set-2.html"><a href="problem-set-2.html"><i class="fa fa-check"></i><b>12</b> Problem Set 2</a>
<ul>
<li class="chapter" data-level="12.1" data-path="problem-set-2.html"><a href="problem-set-2.html#q1-1"><i class="fa fa-check"></i><b>12.1</b> Q1</a></li>
<li class="chapter" data-level="12.2" data-path="problem-set-2.html"><a href="problem-set-2.html#q2-1"><i class="fa fa-check"></i><b>12.2</b> Q2</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="problem-set-2.html"><a href="problem-set-2.html#part-a"><i class="fa fa-check"></i><b>12.2.1</b> Part A</a></li>
<li class="chapter" data-level="12.2.2" data-path="problem-set-2.html"><a href="problem-set-2.html#part-b"><i class="fa fa-check"></i><b>12.2.2</b> Part B</a></li>
<li class="chapter" data-level="12.2.3" data-path="problem-set-2.html"><a href="problem-set-2.html#part-c"><i class="fa fa-check"></i><b>12.2.3</b> Part C</a></li>
<li class="chapter" data-level="12.2.4" data-path="problem-set-2.html"><a href="problem-set-2.html#part-d"><i class="fa fa-check"></i><b>12.2.4</b> Part D</a></li>
<li class="chapter" data-level="12.2.5" data-path="problem-set-2.html"><a href="problem-set-2.html#part-e"><i class="fa fa-check"></i><b>12.2.5</b> Part E</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="problem-set-2.html"><a href="problem-set-2.html#q3-1"><i class="fa fa-check"></i><b>12.3</b> Q3</a></li>
<li class="chapter" data-level="12.4" data-path="problem-set-2.html"><a href="problem-set-2.html#q4-1"><i class="fa fa-check"></i><b>12.4</b> Q4</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="problem-set-2.html"><a href="problem-set-2.html#part-a-1"><i class="fa fa-check"></i><b>12.4.1</b> Part A</a></li>
<li class="chapter" data-level="12.4.2" data-path="problem-set-2.html"><a href="problem-set-2.html#part-b-1"><i class="fa fa-check"></i><b>12.4.2</b> Part B</a></li>
<li class="chapter" data-level="12.4.3" data-path="problem-set-2.html"><a href="problem-set-2.html#part-c-1"><i class="fa fa-check"></i><b>12.4.3</b> Part C</a>
<ul>
<li class="chapter" data-level="12.4.3.1" data-path="problem-set-2.html"><a href="problem-set-2.html#part-i"><i class="fa fa-check"></i><b>12.4.3.1</b> Part i</a></li>
<li class="chapter" data-level="12.4.3.2" data-path="problem-set-2.html"><a href="problem-set-2.html#part-ii"><i class="fa fa-check"></i><b>12.4.3.2</b> Part ii</a></li>
<li class="chapter" data-level="12.4.3.3" data-path="problem-set-2.html"><a href="problem-set-2.html#part-iii"><i class="fa fa-check"></i><b>12.4.3.3</b> Part iii</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="problem-set-2.html"><a href="problem-set-2.html#q5"><i class="fa fa-check"></i><b>12.5</b> Q5</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="problem-set-2.html"><a href="problem-set-2.html#part-a-2"><i class="fa fa-check"></i><b>12.5.1</b> Part A</a></li>
<li class="chapter" data-level="12.5.2" data-path="problem-set-2.html"><a href="problem-set-2.html#part-b-2"><i class="fa fa-check"></i><b>12.5.2</b> Part B</a></li>
<li class="chapter" data-level="12.5.3" data-path="problem-set-2.html"><a href="problem-set-2.html#part-c-2"><i class="fa fa-check"></i><b>12.5.3</b> Part C</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="problem-set-3.html"><a href="problem-set-3.html"><i class="fa fa-check"></i><b>13</b> Problem Set 3</a>
<ul>
<li class="chapter" data-level="13.1" data-path="problem-set-3.html"><a href="problem-set-3.html#q1-2"><i class="fa fa-check"></i><b>13.1</b> Q1</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="problem-set-3.html"><a href="problem-set-3.html#part-a-3"><i class="fa fa-check"></i><b>13.1.1</b> Part A</a></li>
<li class="chapter" data-level="13.1.2" data-path="problem-set-3.html"><a href="problem-set-3.html#part-b-3"><i class="fa fa-check"></i><b>13.1.2</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="problem-set-3.html"><a href="problem-set-3.html#q2-2"><i class="fa fa-check"></i><b>13.2</b> Q2</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="problem-set-3.html"><a href="problem-set-3.html#part-a-4"><i class="fa fa-check"></i><b>13.2.1</b> Part A</a></li>
<li class="chapter" data-level="13.2.2" data-path="problem-set-3.html"><a href="problem-set-3.html#part-b-4"><i class="fa fa-check"></i><b>13.2.2</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="problem-set-3.html"><a href="problem-set-3.html#q3-2"><i class="fa fa-check"></i><b>13.3</b> Q3</a></li>
<li class="chapter" data-level="13.4" data-path="problem-set-3.html"><a href="problem-set-3.html#q4-2"><i class="fa fa-check"></i><b>13.4</b> Q4</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="problem-set-4.html"><a href="problem-set-4.html"><i class="fa fa-check"></i><b>14</b> Problem Set 4</a>
<ul>
<li class="chapter" data-level="14.1" data-path="problem-set-4.html"><a href="problem-set-4.html#q1.1"><i class="fa fa-check"></i><b>14.1</b> Q1.1</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="problem-set-4.html"><a href="problem-set-4.html#part-a-5"><i class="fa fa-check"></i><b>14.1.1</b> Part A</a></li>
<li class="chapter" data-level="14.1.2" data-path="problem-set-4.html"><a href="problem-set-4.html#part-b-5"><i class="fa fa-check"></i><b>14.1.2</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="problem-set-4.html"><a href="problem-set-4.html#q1.2"><i class="fa fa-check"></i><b>14.2</b> Q1.2</a></li>
<li class="chapter" data-level="14.3" data-path="problem-set-4.html"><a href="problem-set-4.html#q1.3"><i class="fa fa-check"></i><b>14.3</b> Q1.3</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="problem-set-4.html"><a href="problem-set-4.html#part-a-6"><i class="fa fa-check"></i><b>14.3.1</b> Part A</a></li>
<li class="chapter" data-level="14.3.2" data-path="problem-set-4.html"><a href="problem-set-4.html#part-b-6"><i class="fa fa-check"></i><b>14.3.2</b> Part B</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="problem-set-4.html"><a href="problem-set-4.html#q1.4"><i class="fa fa-check"></i><b>14.4</b> Q1.4</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="q2.html"><a href="q2.html"><i class="fa fa-check"></i><b>15</b> Q2.1</a>
<ul>
<li class="chapter" data-level="15.1" data-path="q2.html"><a href="q2.html#q2.2"><i class="fa fa-check"></i><b>15.1</b> Q2.2</a></li>
<li class="chapter" data-level="15.2" data-path="q2.html"><a href="q2.html#q2.3"><i class="fa fa-check"></i><b>15.2</b> Q2.3</a></li>
<li class="chapter" data-level="15.3" data-path="q2.html"><a href="q2.html#q3-3"><i class="fa fa-check"></i><b>15.3</b> Q3</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="q2.html"><a href="q2.html#part-a-7"><i class="fa fa-check"></i><b>15.3.1</b> Part A</a></li>
<li class="chapter" data-level="15.3.2" data-path="q2.html"><a href="q2.html#part-b-7"><i class="fa fa-check"></i><b>15.3.2</b> Part B</a></li>
<li class="chapter" data-level="15.3.3" data-path="q2.html"><a href="q2.html#part-c-3"><i class="fa fa-check"></i><b>15.3.3</b> Part c</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAD70 Course Work</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="q2.1" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">Chapter 15</span> Q2.1<a href="q2.html#q2.1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Write an R program to find the efficient frontier, the tangency portfolio, and the minimum variance portfolio, and plot on “reward-risk space” the location of each of the six stocks, the efficient frontier, the tangency portfolio, and the line of efficient portfolios. Use the constraints that −0.1 ≤ wj ≤ 0.5 for each stock. The first constraint limits short sales but does not rule them out completely. The second constraint prohibits more than 50 % of the investment in any single stock. Assume that the annual risk-free rate is 3 % and convert this to a daily rate by dividing by 365, since interest is earned on trading as well as nontrading days.</p>
<blockquote>
<p>Taken straight from the answer key</p>
</blockquote>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="q2.html#cb53-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb53-2"><a href="q2.html#cb53-2" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;ProblemSets/datasets/Stock_Bond.csv&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb53-3"><a href="q2.html#cb53-3" tabindex="-1"></a>prices <span class="ot">=</span> <span class="fu">cbind</span>(dat<span class="sc">$</span>GM_AC, dat<span class="sc">$</span>F_AC, dat<span class="sc">$</span>CAT_AC, dat<span class="sc">$</span>UTX_AC,</span>
<span id="cb53-4"><a href="q2.html#cb53-4" tabindex="-1"></a>  dat<span class="sc">$</span>MRK_AC, dat<span class="sc">$</span>IBM_AC)</span>
<span id="cb53-5"><a href="q2.html#cb53-5" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">dim</span>(prices)[<span class="dv">1</span>]</span>
<span id="cb53-6"><a href="q2.html#cb53-6" tabindex="-1"></a>returns <span class="ot">=</span>  <span class="dv">100</span> <span class="sc">*</span> (prices[<span class="dv">2</span><span class="sc">:</span>n, ] <span class="sc">/</span> prices[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>), ] <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb53-7"><a href="q2.html#cb53-7" tabindex="-1"></a><span class="fu">pairs</span>(returns)</span></code></pre></div>
<p><img src="_main_files/figure-html/eval-1.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="q2.html#cb54-1" tabindex="-1"></a>mean_vect <span class="ot">=</span> <span class="fu">colMeans</span>(returns)</span>
<span id="cb54-2"><a href="q2.html#cb54-2" tabindex="-1"></a>cov_mat <span class="ot">=</span> <span class="fu">cov</span>(returns)</span>
<span id="cb54-3"><a href="q2.html#cb54-3" tabindex="-1"></a>sd_vect <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(cov_mat))</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="q2.html#cb55-1" tabindex="-1"></a>M <span class="ot">=</span> <span class="fu">length</span>(mean_vect)</span>
<span id="cb55-2"><a href="q2.html#cb55-2" tabindex="-1"></a><span class="fu">library</span>(quadprog)</span>
<span id="cb55-3"><a href="q2.html#cb55-3" tabindex="-1"></a>Amat <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>,M),mean_vect,<span class="fu">diag</span>(<span class="dv">1</span>,<span class="at">nrow=</span>M),<span class="sc">-</span><span class="fu">diag</span>(<span class="dv">1</span>,<span class="at">nrow=</span>M))</span>
<span id="cb55-4"><a href="q2.html#cb55-4" tabindex="-1"></a>muP <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(mean_vect)<span class="sc">+</span>.<span class="dv">02</span>,<span class="fu">max</span>(mean_vect)<span class="sc">-</span>.<span class="dv">02</span>,<span class="at">length=</span><span class="dv">10</span>)</span>
<span id="cb55-5"><a href="q2.html#cb55-5" tabindex="-1"></a>muP <span class="ot">=</span> <span class="fu">seq</span>(.<span class="dv">05</span>,<span class="fl">0.08</span>,<span class="at">length=</span><span class="dv">300</span>)</span>
<span id="cb55-6"><a href="q2.html#cb55-6" tabindex="-1"></a>sdP <span class="ot">=</span> muP</span>
<span id="cb55-7"><a href="q2.html#cb55-7" tabindex="-1"></a>weights <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">300</span>,<span class="at">ncol=</span>M)</span>
<span id="cb55-8"><a href="q2.html#cb55-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(muP))</span>
<span id="cb55-9"><a href="q2.html#cb55-9" tabindex="-1"></a>{</span>
<span id="cb55-10"><a href="q2.html#cb55-10" tabindex="-1"></a>result <span class="ot">=</span></span>
<span id="cb55-11"><a href="q2.html#cb55-11" tabindex="-1"></a><span class="fu">solve.QP</span>(<span class="at">Dmat=</span>cov_mat,<span class="at">dvec=</span><span class="fu">rep</span>(<span class="dv">0</span>,M), <span class="at">Amat=</span>Amat,</span>
<span id="cb55-12"><a href="q2.html#cb55-12" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>,muP[i],<span class="fu">rep</span>(<span class="sc">-</span>.<span class="dv">1</span>,M),<span class="fu">rep</span>(<span class="sc">-</span>.<span class="dv">5</span>,M)), <span class="at">meq=</span><span class="dv">2</span>)</span>
<span id="cb55-13"><a href="q2.html#cb55-13" tabindex="-1"></a>sdP[i] <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>result<span class="sc">$</span>value)</span>
<span id="cb55-14"><a href="q2.html#cb55-14" tabindex="-1"></a>weights[i,] <span class="ot">=</span> result<span class="sc">$</span>solution</span>
<span id="cb55-15"><a href="q2.html#cb55-15" tabindex="-1"></a>}</span>
<span id="cb55-16"><a href="q2.html#cb55-16" tabindex="-1"></a><span class="fu">plot</span>(sdP,muP,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">2.5</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">1</span>))</span>
<span id="cb55-17"><a href="q2.html#cb55-17" tabindex="-1"></a>mufree <span class="ot">=</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">365</span></span>
<span id="cb55-18"><a href="q2.html#cb55-18" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span>,mufree,<span class="at">cex=</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>)</span>
<span id="cb55-19"><a href="q2.html#cb55-19" tabindex="-1"></a>sharpe <span class="ot">=</span>( muP<span class="sc">-</span>mufree)<span class="sc">/</span>sdP</span>
<span id="cb55-20"><a href="q2.html#cb55-20" tabindex="-1"></a>ind <span class="ot">=</span> (sharpe <span class="sc">==</span> <span class="fu">max</span>(sharpe)) <span class="co"># locates the tangency portfolio</span></span>
<span id="cb55-21"><a href="q2.html#cb55-21" tabindex="-1"></a>weights[ind,] <span class="co"># weights of the tangency portfolio</span></span></code></pre></div>
<pre><code>## [1] -0.091181044 -0.002910879  0.335318542  0.383714329  0.319484849
## [6]  0.055574204</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="q2.html#cb57-1" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">0</span>,sdP[ind]),<span class="fu">c</span>(mufree,muP[ind]),<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb57-2"><a href="q2.html#cb57-2" tabindex="-1"></a><span class="fu">points</span>(sdP[ind],muP[ind],<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>)</span>
<span id="cb57-3"><a href="q2.html#cb57-3" tabindex="-1"></a>ind2 <span class="ot">=</span> (sdP <span class="sc">==</span> <span class="fu">min</span>(sdP))</span>
<span id="cb57-4"><a href="q2.html#cb57-4" tabindex="-1"></a><span class="fu">points</span>(sdP[ind2],muP[ind2],<span class="at">col=</span><span class="st">&quot;green&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>)</span>
<span id="cb57-5"><a href="q2.html#cb57-5" tabindex="-1"></a>ind3 <span class="ot">=</span> (muP <span class="sc">&gt;</span> muP[ind2])</span>
<span id="cb57-6"><a href="q2.html#cb57-6" tabindex="-1"></a><span class="fu">lines</span>(sdP[ind3],muP[ind3],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">25</span>),</span>
<span id="cb57-7"><a href="q2.html#cb57-7" tabindex="-1"></a><span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">3</span>),<span class="at">col=</span><span class="st">&quot;cyan&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb57-8"><a href="q2.html#cb57-8" tabindex="-1"></a><span class="fu">text</span>(sd_vect[<span class="dv">1</span>],mean_vect[<span class="dv">1</span>],<span class="st">&quot;GM&quot;</span>)</span>
<span id="cb57-9"><a href="q2.html#cb57-9" tabindex="-1"></a><span class="fu">text</span>(sd_vect[<span class="dv">2</span>],mean_vect[<span class="dv">2</span>],<span class="st">&quot;F&quot;</span>)</span>
<span id="cb57-10"><a href="q2.html#cb57-10" tabindex="-1"></a><span class="fu">text</span>(sd_vect[<span class="dv">3</span>],mean_vect[<span class="dv">3</span>],<span class="st">&quot;UTX&quot;</span>)</span>
<span id="cb57-11"><a href="q2.html#cb57-11" tabindex="-1"></a><span class="fu">text</span>(sd_vect[<span class="dv">4</span>],mean_vect[<span class="dv">4</span>],<span class="st">&quot;CAT&quot;</span>)</span>
<span id="cb57-12"><a href="q2.html#cb57-12" tabindex="-1"></a><span class="fu">text</span>(sd_vect[<span class="dv">5</span>],mean_vect[<span class="dv">5</span>],<span class="st">&quot;MRK&quot;</span>)</span>
<span id="cb57-13"><a href="q2.html#cb57-13" tabindex="-1"></a><span class="fu">text</span>(sd_vect[<span class="dv">6</span>],mean_vect[<span class="dv">6</span>],<span class="st">&quot;IBM&quot;</span>)</span>
<span id="cb57-14"><a href="q2.html#cb57-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;efficient frontier&quot;</span>,<span class="st">&quot;efficient portfolios&quot;</span>, </span>
<span id="cb57-15"><a href="q2.html#cb57-15" tabindex="-1"></a>                   <span class="st">&quot;tangency portfolio&quot;</span>,<span class="st">&quot;min var portfolio&quot;</span>),</span>
<span id="cb57-16"><a href="q2.html#cb57-16" tabindex="-1"></a>       <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb57-17"><a href="q2.html#cb57-17" tabindex="-1"></a>       <span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb57-18"><a href="q2.html#cb57-18" tabindex="-1"></a>       <span class="at">pch=</span><span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;*&quot;</span>,<span class="st">&quot;*&quot;</span>),</span>
<span id="cb57-19"><a href="q2.html#cb57-19" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;cyan&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;green&quot;</span>),</span>
<span id="cb57-20"><a href="q2.html#cb57-20" tabindex="-1"></a>       <span class="at">pt.cex=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb57-21"><a href="q2.html#cb57-21" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<div id="q2.2" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Q2.2<a href="q2.html#q2.2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If an investor wants an efficient portfolio with an expected daily return of 0.07%, how should the investor allocate his or her capital to the six stocks and to the risk-free asset? Assume that the investor wishes to use the tangency portfolio computed with the constraints <span class="math inline">\(−0.1 \leq w_j \leq 0.5\)</span>, not the unconstrained tangency portfolio.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="q2.html#cb58-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">3</span>)</span>
<span id="cb58-2"><a href="q2.html#cb58-2" tabindex="-1"></a><span class="co"># it divides by the risk free rate converted to daily but theres a typo,</span></span>
<span id="cb58-3"><a href="q2.html#cb58-3" tabindex="-1"></a><span class="co"># should be 3/365 (unless this is the amt of trading days, but that would be 252)</span></span>
<span id="cb58-4"><a href="q2.html#cb58-4" tabindex="-1"></a><span class="co"># omega = (.07 - muP[ind]) / (3/265 - muP[ind])</span></span>
<span id="cb58-5"><a href="q2.html#cb58-5" tabindex="-1"></a>omega <span class="ot">=</span> (.<span class="dv">07</span> <span class="sc">-</span> muP[ind]) <span class="sc">/</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">365</span> <span class="sc">-</span> muP[ind])</span>
<span id="cb58-6"><a href="q2.html#cb58-6" tabindex="-1"></a>omega</span></code></pre></div>
<pre><code>## [1] 0.0518</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="q2.html#cb60-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span>omega</span></code></pre></div>
<pre><code>## [1] 0.948</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="q2.html#cb62-1" tabindex="-1"></a>(<span class="dv">1</span><span class="sc">-</span>omega)<span class="sc">*</span>weights[ind]</span></code></pre></div>
<pre><code>## [1] -0.08645 -0.00276  0.31794  0.36382  0.30292  0.05269</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="q2.html#cb64-1" tabindex="-1"></a>omega <span class="sc">+</span> <span class="fu">sum</span>((<span class="dv">1</span><span class="sc">-</span>omega)<span class="sc">*</span>weights[ind])</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<div id="q2.3" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Q2.3<a href="q2.html#q2.3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Does this data set include Black Monday?</p>
<blockquote>
<p>Again, straight from the answer key.</p>
</blockquote>
<p>Yes, Black Monday was October 19, 1987 and data go from January 2, 1987 to
Sept 1, 2006. Black Monday is the 202th day in the original data set or the
201st day of returns.
If you look in the spread sheet you will see huge price declines that day. The
returns that day were:</p>
<pre><code>returns[201,]
[1] -21.0 -18.2 -21.7 -15.7 -13.0 -23.5</code></pre>
</div>
<div id="q3-3" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Q3<a href="q2.html#q3-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>From answer key:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="q2.html#cb67-1" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb67-2"><a href="q2.html#cb67-2" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb67-3"><a href="q2.html#cb67-3" tabindex="-1"></a></span>
<span id="cb67-4"><a href="q2.html#cb67-4" tabindex="-1"></a>tickers <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;ENB.TO&quot;</span>,<span class="st">&quot;CP.TO&quot;</span>,<span class="st">&quot;RCI-A.TO&quot;</span>,<span class="st">&quot;TD.TO&quot;</span>,<span class="st">&quot;L.TO&quot;</span>)</span>
<span id="cb67-5"><a href="q2.html#cb67-5" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">length</span>(tickers)</span>
<span id="cb67-6"><a href="q2.html#cb67-6" tabindex="-1"></a></span>
<span id="cb67-7"><a href="q2.html#cb67-7" tabindex="-1"></a>P<span class="ot">=</span><span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, N) <span class="co"># list for holding prices</span></span>
<span id="cb67-8"><a href="q2.html#cb67-8" tabindex="-1"></a></span>
<span id="cb67-9"><a href="q2.html#cb67-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb67-10"><a href="q2.html#cb67-10" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Downloading &quot;</span>, i, <span class="st">&quot; out of &quot;</span>, N , <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb67-11"><a href="q2.html#cb67-11" tabindex="-1"></a>  P[[i]] <span class="ot">=</span> <span class="fu">get.hist.quote</span>(<span class="at">instrument =</span> tickers[i], </span>
<span id="cb67-12"><a href="q2.html#cb67-12" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2010-01-01&quot;</span>), </span>
<span id="cb67-13"><a href="q2.html#cb67-13" tabindex="-1"></a>    <span class="at">end=</span><span class="fu">as.Date</span>(<span class="st">&quot;2020-12-01&quot;</span>), </span>
<span id="cb67-14"><a href="q2.html#cb67-14" tabindex="-1"></a>    <span class="at">compression=</span><span class="st">&quot;m&quot;</span>, <span class="at">quote =</span> <span class="st">&quot;AdjClose&quot;</span>, </span>
<span id="cb67-15"><a href="q2.html#cb67-15" tabindex="-1"></a>    <span class="at">retclass =</span> <span class="st">&quot;zoo&quot;</span>, <span class="at">quiet =</span> T)</span>
<span id="cb67-16"><a href="q2.html#cb67-16" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Downloading  1  out of  5 
## Downloading  2  out of  5 
## Downloading  3  out of  5 
## Downloading  4  out of  5 
## Downloading  5  out of  5</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="q2.html#cb69-1" tabindex="-1"></a><span class="co"># net returns</span></span>
<span id="cb69-2"><a href="q2.html#cb69-2" tabindex="-1"></a>R <span class="ot">=</span> <span class="fu">sapply</span>(P, <span class="at">FUN=</span><span class="cf">function</span>(x){ <span class="fu">as.numeric</span>(<span class="fu">diff</span>(x) <span class="sc">/</span> stats<span class="sc">::</span><span class="fu">lag</span>(x, <span class="sc">-</span><span class="dv">1</span>)) } )</span>
<span id="cb69-3"><a href="q2.html#cb69-3" tabindex="-1"></a><span class="fu">colnames</span>(R) <span class="ot">=</span> tickers <span class="co"># assign names</span></span></code></pre></div>
<div id="part-a-7" class="section level3 hasAnchor" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> Part A<a href="q2.html#part-a-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use only the first two stocks (ENB.TO and CP.TO), and calculate the sample means and (individual) sample variances of their returns. Consider the following hypothetical values for their correlation : <span class="math inline">\(\rho\)</span> = −1, −0.5, 0, +0.5, +1.
For each value of <span class="math inline">\(\rho\)</span>, calculate their corresponding 2D variance-covariance matrix and plot the risk-return profiles of portfolios combining the two assets with weights [w, (1 − w)], <span class="math inline">\(\forall w \in [−1, 2]\)</span>. Plot all profile curves on the same (<span class="math inline">\(\mu_p, \sigma_p\)</span>)-space, using a different color for each value of <span class="math inline">\(\rho\)</span>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="q2.html#cb70-1" tabindex="-1"></a>R2<span class="ot">=</span>R[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb70-2"><a href="q2.html#cb70-2" tabindex="-1"></a>MU <span class="ot">=</span> <span class="fu">colMeans</span>(R2)</span>
<span id="cb70-3"><a href="q2.html#cb70-3" tabindex="-1"></a>SD <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">var</span>(R2)))</span>
<span id="cb70-4"><a href="q2.html#cb70-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">0.1</span>)</span>
<span id="cb70-5"><a href="q2.html#cb70-5" tabindex="-1"></a><span class="fu">plot</span>(SD,MU,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">15</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.005</span>,.<span class="dv">025</span>))</span>
<span id="cb70-6"><a href="q2.html#cb70-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>) </span>
<span id="cb70-7"><a href="q2.html#cb70-7" tabindex="-1"></a></span>
<span id="cb70-8"><a href="q2.html#cb70-8" tabindex="-1"></a>w <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">+</span><span class="dv">3</span>,.<span class="dv">01</span>); W <span class="ot">=</span> <span class="fu">cbind</span>(w, <span class="dv">1</span><span class="sc">-</span>w) <span class="co"># weights</span></span>
<span id="cb70-9"><a href="q2.html#cb70-9" tabindex="-1"></a>MU.p <span class="ot">=</span> W <span class="sc">%*%</span> MU    <span class="co"># portfolio means</span></span>
<span id="cb70-10"><a href="q2.html#cb70-10" tabindex="-1"></a></span>
<span id="cb70-11"><a href="q2.html#cb70-11" tabindex="-1"></a>rho<span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">5</span>, <span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>) <span class="co"># correlations</span></span>
<span id="cb70-12"><a href="q2.html#cb70-12" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb70-13"><a href="q2.html#cb70-13" tabindex="-1"></a>  COR<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,rho[i],rho[i],<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb70-14"><a href="q2.html#cb70-14" tabindex="-1"></a>  COV<span class="ot">=</span> COR <span class="sc">*</span> (SD<span class="sc">%*%</span><span class="fu">t</span>(SD))</span>
<span id="cb70-15"><a href="q2.html#cb70-15" tabindex="-1"></a>  SD.p <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">rowSums</span>((W <span class="sc">%*%</span> COV)<span class="sc">*</span>W)) <span class="co"># portfolio st.dev.</span></span>
<span id="cb70-16"><a href="q2.html#cb70-16" tabindex="-1"></a>  <span class="fu">lines</span>(SD.p, MU.p, <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>i); </span>
<span id="cb70-17"><a href="q2.html#cb70-17" tabindex="-1"></a>}</span>
<span id="cb70-18"><a href="q2.html#cb70-18" tabindex="-1"></a></span>
<span id="cb70-19"><a href="q2.html#cb70-19" tabindex="-1"></a><span class="fu">points</span>(SD,MU,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb70-20"><a href="q2.html#cb70-20" tabindex="-1"></a><span class="fu">text</span>(SD, MU, <span class="at">pch=</span><span class="dv">16</span>, <span class="fu">colnames</span>(R2), <span class="at">pos=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb70-21"><a href="q2.html#cb70-21" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="at">lwd=</span><span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">5</span>),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb70-22"><a href="q2.html#cb70-22" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">&quot;rho=-1&quot;</span>,<span class="st">&quot;rho=-.5&quot;</span>,<span class="st">&quot;rho=0&quot;</span>,<span class="st">&quot;rho=+.5&quot;</span>,<span class="st">&quot;rho=+1&quot;</span>)  )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="part-b-7" class="section level3 hasAnchor" number="15.3.2">
<h3><span class="header-section-number">15.3.2</span> Part B<a href="q2.html#part-b-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider all 5 stocks together now, and use the sample mean and sample variance-covariance matrix of their returns. Plot the efficient frontier and the capital market line on the same (<span class="math inline">\(\mu_p,\sigma_p\)</span>)-space and report the tangency portfolio weights.
(Hint: adapt the code from Example 16.6 on p. 476 of SDAFE.)</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="q2.html#cb71-1" tabindex="-1"></a><span class="fu">library</span>(quadprog)</span>
<span id="cb71-2"><a href="q2.html#cb71-2" tabindex="-1"></a></span>
<span id="cb71-3"><a href="q2.html#cb71-3" tabindex="-1"></a>COV<span class="ot">=</span><span class="fu">cov</span>(R)</span>
<span id="cb71-4"><a href="q2.html#cb71-4" tabindex="-1"></a>MU<span class="ot">=</span><span class="fu">colMeans</span>(R)</span>
<span id="cb71-5"><a href="q2.html#cb71-5" tabindex="-1"></a>SD<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">diag</span>(COV))</span>
<span id="cb71-6"><a href="q2.html#cb71-6" tabindex="-1"></a>N<span class="ot">=</span><span class="fu">dim</span>(R)[<span class="dv">2</span>] </span>
<span id="cb71-7"><a href="q2.html#cb71-7" tabindex="-1"></a></span>
<span id="cb71-8"><a href="q2.html#cb71-8" tabindex="-1"></a><span class="fu">plot</span>(SD, MU, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">col=</span> <span class="dv">2</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">025</span>))</span>
<span id="cb71-9"><a href="q2.html#cb71-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>) </span>
<span id="cb71-10"><a href="q2.html#cb71-10" tabindex="-1"></a><span class="fu">text</span>(SD, MU, tickers, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb71-11"><a href="q2.html#cb71-11" tabindex="-1"></a></span>
<span id="cb71-12"><a href="q2.html#cb71-12" tabindex="-1"></a>Amat <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>,N),MU)</span>
<span id="cb71-13"><a href="q2.html#cb71-13" tabindex="-1"></a>mu.p <span class="ot">=</span> <span class="fu">seq</span>( <span class="sc">-</span>.<span class="dv">005</span>, .<span class="dv">05</span>,<span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb71-14"><a href="q2.html#cb71-14" tabindex="-1"></a>sd.p <span class="ot">=</span> mu.p; </span>
<span id="cb71-15"><a href="q2.html#cb71-15" tabindex="-1"></a></span>
<span id="cb71-16"><a href="q2.html#cb71-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mu.p)) </span>
<span id="cb71-17"><a href="q2.html#cb71-17" tabindex="-1"></a>{</span>
<span id="cb71-18"><a href="q2.html#cb71-18" tabindex="-1"></a>  bvec<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,mu.p[i]) </span>
<span id="cb71-19"><a href="q2.html#cb71-19" tabindex="-1"></a>  out<span class="ot">=</span><span class="fu">solve.QP</span>(<span class="at">Dmat=</span><span class="dv">2</span><span class="sc">*</span>COV,<span class="at">dvec=</span><span class="fu">rep</span>(<span class="dv">0</span>,N),<span class="at">Amat=</span>Amat,<span class="at">bvec=</span>bvec,<span class="at">meq=</span><span class="dv">2</span>)</span>
<span id="cb71-20"><a href="q2.html#cb71-20" tabindex="-1"></a>  sd.p[i] <span class="ot">=</span> <span class="fu">sqrt</span>(out<span class="sc">$</span>value)</span>
<span id="cb71-21"><a href="q2.html#cb71-21" tabindex="-1"></a>}</span>
<span id="cb71-22"><a href="q2.html#cb71-22" tabindex="-1"></a><span class="fu">lines</span>(sd.p,mu.p,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>) <span class="co"># plot least variance portfolios</span></span>
<span id="cb71-23"><a href="q2.html#cb71-23" tabindex="-1"></a></span>
<span id="cb71-24"><a href="q2.html#cb71-24" tabindex="-1"></a>mu.f <span class="ot">=</span> .<span class="dv">002</span> <span class="co"># monthly risk-free interest rate</span></span>
<span id="cb71-25"><a href="q2.html#cb71-25" tabindex="-1"></a></span>
<span id="cb71-26"><a href="q2.html#cb71-26" tabindex="-1"></a>COV.i<span class="ot">=</span><span class="fu">solve</span>(COV)</span>
<span id="cb71-27"><a href="q2.html#cb71-27" tabindex="-1"></a>W.tang<span class="ot">=</span>COV.i<span class="sc">%*%</span>(MU<span class="sc">-</span>mu.f) <span class="sc">/</span> <span class="fu">sum</span>( COV.i<span class="sc">%*%</span>(MU<span class="sc">-</span>mu.f) )</span>
<span id="cb71-28"><a href="q2.html#cb71-28" tabindex="-1"></a>mu.tang<span class="ot">=</span><span class="fu">sum</span>(W.tang<span class="sc">*</span>MU)                             </span>
<span id="cb71-29"><a href="q2.html#cb71-29" tabindex="-1"></a>sd.tang<span class="ot">=</span><span class="fu">sqrt</span>(<span class="fu">sum</span>( (COV <span class="sc">%*%</span> W.tang) <span class="sc">*</span> W.tang ) )    </span>
<span id="cb71-30"><a href="q2.html#cb71-30" tabindex="-1"></a><span class="fu">points</span>( sd.tang, mu.tang, <span class="at">pch=</span><span class="dv">15</span>, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">col=</span><span class="dv">2</span>)  </span>
<span id="cb71-31"><a href="q2.html#cb71-31" tabindex="-1"></a>sharpe<span class="ot">=</span>(mu.tang<span class="sc">-</span>mu.f)<span class="sc">/</span>sd.tang</span>
<span id="cb71-32"><a href="q2.html#cb71-32" tabindex="-1"></a><span class="fu">abline</span>(mu.f,sharpe,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>The Sharpe ratio is 0.335, and the tangency portfolio weights are:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="q2.html#cb72-1" tabindex="-1"></a><span class="fu">round</span>( <span class="fu">t</span>(W.tang), <span class="dv">4</span> )</span></code></pre></div>
<pre><code>##      ENB.TO CP.TO RCI-A.TO TD.TO  L.TO
## [1,]  0.135 0.362    0.106 0.248 0.149</code></pre>
</div>
<div id="part-c-3" class="section level3 hasAnchor" number="15.3.3">
<h3><span class="header-section-number">15.3.3</span> Part c<a href="q2.html#part-c-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Repeat the previous part b. (i.e. plot the efficient frontier and capital market line, and report the tangency portfolio weights) with the restriction that all weights are within the bounds <span class="math inline">\(0 \le w_i \le 0.5,\;\; \forall i = 1, \ldots, 5\)</span>.
(Hint: adapt the code from Example 16.7 on p. 479 of SDAFE.)</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="q2.html#cb74-1" tabindex="-1"></a><span class="fu">plot</span>(SD, MU, <span class="at">pch=</span><span class="dv">16</span>, <span class="at">cex=</span><span class="fl">1.2</span>, <span class="at">col=</span> <span class="dv">2</span>,  <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(.<span class="dv">0</span>,.<span class="dv">025</span>))</span>
<span id="cb74-2"><a href="q2.html#cb74-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>) </span>
<span id="cb74-3"><a href="q2.html#cb74-3" tabindex="-1"></a><span class="fu">text</span>(SD, MU, tickers, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb74-4"><a href="q2.html#cb74-4" tabindex="-1"></a></span>
<span id="cb74-5"><a href="q2.html#cb74-5" tabindex="-1"></a>Amat <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>,N),MU,<span class="fu">diag</span>(<span class="dv">1</span>,<span class="at">nrow=</span>N),<span class="sc">-</span><span class="fu">diag</span>(<span class="dv">1</span>,<span class="at">nrow=</span>N))</span>
<span id="cb74-6"><a href="q2.html#cb74-6" tabindex="-1"></a>mu.pot <span class="ot">=</span> <span class="fu">seq</span>( <span class="fu">min</span>(MU), <span class="fu">max</span>(MU),<span class="at">length=</span><span class="dv">300</span>) <span class="co"># potential mean returns</span></span>
<span id="cb74-7"><a href="q2.html#cb74-7" tabindex="-1"></a></span>
<span id="cb74-8"><a href="q2.html#cb74-8" tabindex="-1"></a>mu.p <span class="ot">=</span> <span class="cn">NULL</span> <span class="co"># initialize portofio standard error </span></span>
<span id="cb74-9"><a href="q2.html#cb74-9" tabindex="-1"></a>sd.p <span class="ot">=</span> <span class="cn">NULL</span> <span class="co"># initialize portofio standard error </span></span>
<span id="cb74-10"><a href="q2.html#cb74-10" tabindex="-1"></a>W.p <span class="ot">=</span> <span class="cn">NULL</span> <span class="co"># initialize portofio weights </span></span>
<span id="cb74-11"><a href="q2.html#cb74-11" tabindex="-1"></a></span>
<span id="cb74-12"><a href="q2.html#cb74-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mu.pot)) </span>
<span id="cb74-13"><a href="q2.html#cb74-13" tabindex="-1"></a>{</span>
<span id="cb74-14"><a href="q2.html#cb74-14" tabindex="-1"></a>  bvec<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,mu.pot[i],<span class="fu">rep</span>(<span class="dv">0</span>,N),<span class="fu">rep</span>(<span class="sc">-</span><span class="fl">0.5</span>,N))</span>
<span id="cb74-15"><a href="q2.html#cb74-15" tabindex="-1"></a>  <span class="co">#check whether potential mean return can be achieved with given constraints</span></span>
<span id="cb74-16"><a href="q2.html#cb74-16" tabindex="-1"></a>  out<span class="ot">=</span><span class="fu">tryCatch</span>( <span class="fu">solve.QP</span>(<span class="at">Dmat=</span><span class="dv">2</span><span class="sc">*</span>COV,<span class="at">dvec=</span><span class="fu">rep</span>(<span class="dv">0</span>,N),<span class="at">Amat=</span>Amat,<span class="at">bvec=</span>bvec,<span class="at">meq=</span><span class="dv">2</span>), <span class="at">error=</span><span class="cf">function</span>(e) <span class="cn">NULL</span>) </span>
<span id="cb74-17"><a href="q2.html#cb74-17" tabindex="-1"></a>  <span class="co">#if mean return is achievable, save its st.dev. &amp; portfolio weights</span></span>
<span id="cb74-18"><a href="q2.html#cb74-18" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(out)){ <span class="co">#  if</span></span>
<span id="cb74-19"><a href="q2.html#cb74-19" tabindex="-1"></a>    mu.p<span class="ot">=</span><span class="fu">c</span>(mu.p, mu.pot[i])</span>
<span id="cb74-20"><a href="q2.html#cb74-20" tabindex="-1"></a>    sd.p<span class="ot">=</span><span class="fu">c</span>(sd.p, <span class="fu">sqrt</span>(out<span class="sc">$</span>value))</span>
<span id="cb74-21"><a href="q2.html#cb74-21" tabindex="-1"></a>    W.p<span class="ot">=</span><span class="fu">rbind</span>(W.p, out<span class="sc">$</span>solution)</span>
<span id="cb74-22"><a href="q2.html#cb74-22" tabindex="-1"></a>  }</span>
<span id="cb74-23"><a href="q2.html#cb74-23" tabindex="-1"></a>}</span>
<span id="cb74-24"><a href="q2.html#cb74-24" tabindex="-1"></a><span class="fu">lines</span>(sd.p,mu.p,<span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>) <span class="co"># plot least variance portfolios</span></span>
<span id="cb74-25"><a href="q2.html#cb74-25" tabindex="-1"></a><span class="fu">colnames</span>(W.p)<span class="ot">=</span>tickers</span>
<span id="cb74-26"><a href="q2.html#cb74-26" tabindex="-1"></a></span>
<span id="cb74-27"><a href="q2.html#cb74-27" tabindex="-1"></a>sharpe<span class="ot">=</span>( mu.p<span class="sc">-</span>mu.f)<span class="sc">/</span>sd.p</span>
<span id="cb74-28"><a href="q2.html#cb74-28" tabindex="-1"></a>ind.tang<span class="ot">=</span><span class="fu">which.max</span>(sharpe)</span>
<span id="cb74-29"><a href="q2.html#cb74-29" tabindex="-1"></a>W.tang<span class="ot">=</span>W.p[ind.tang,]</span>
<span id="cb74-30"><a href="q2.html#cb74-30" tabindex="-1"></a>sd.tang <span class="ot">=</span> sd.p[ind.tang] </span>
<span id="cb74-31"><a href="q2.html#cb74-31" tabindex="-1"></a>mu.tang <span class="ot">=</span> mu.p[ind.tang]</span>
<span id="cb74-32"><a href="q2.html#cb74-32" tabindex="-1"></a><span class="fu">points</span>( sd.tang, mu.tang, <span class="at">pch=</span><span class="dv">15</span>, <span class="at">cex=</span><span class="fl">1.3</span>, <span class="at">col=</span><span class="dv">2</span>)  </span>
<span id="cb74-33"><a href="q2.html#cb74-33" tabindex="-1"></a><span class="fu">abline</span>( <span class="fu">c</span>(mu.f, sharpe[ind.tang]),<span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>The set of feasible portfolios will be a subset of that of the unconstrained problem. Note that the <em>constrained</em> efficient frontier is not a parabola any more. But the constrained tangency portfolio is the same as the unconstrained one (since the since the unconstrained tangency portfolio weights were all within [0,.5]), and have (approximately) the same Sharpe ratio 0.335.</p>
<p>Note that the constrained tangency portfolio weights are (approximately) the same as the unconstrained ones:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="q2.html#cb75-1" tabindex="-1"></a><span class="fu">round</span>( W.tang, <span class="dv">4</span> )</span></code></pre></div>
<pre><code>##   ENB.TO    CP.TO RCI-A.TO    TD.TO     L.TO 
##    0.135    0.362    0.106    0.248    0.149</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="problem-set-4.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/ProblemSets/PS4.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
